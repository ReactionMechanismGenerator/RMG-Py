<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. The rmg.graph Module &mdash; RMG-Py</title>
    <link rel="stylesheet" href="../../static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.2.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../static/jquery.js"></script>
    <script type="text/javascript" src="../../static/doctools.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within RMG-Py"
          href="../../static/opensearch.xml"/>
    <link rel="top" title="RMG-Py" href="../../index.html" />
    <link rel="up" title="RMG Developer’s Guide" href="index.html" />
    <link rel="next" title="5. The rmg.io Module" href="rmg-io.html" />
    <link rel="prev" title="3. The rmg.data Module" href="rmg-data.html" /> 
 
<link rel="stylesheet" href="../../static/rmg.css" type="text/css" />

  </head>
  <body>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-7791083-1");
pageTracker._trackPageview();
} catch(err) {}</script>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="rmg-io.html" title="5. The rmg.io Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="rmg-data.html" title="3. The rmg.data Module"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">RMG-Py</a> &raquo;</li>
          <li><a href="../index.html" >RMG Documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">RMG Developer&#8217;s Guide</a> &raquo;</li>
  <li><a href="">4. The <tt class="docutils literal docutils literal"><span class="pre">rmg.graph</span></tt> Module</a></li>

      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-rmg.graph">
<h1>4. The <tt class="docutils literal"><span class="pre">rmg.graph</span></tt> Module<a class="headerlink" href="#module-rmg.graph" title="Permalink to this headline">¶</a></h1>
<p>Contains an implementation of a graph data structure (the <a title="rmg.graph.Graph" class="reference internal" href="#rmg.graph.Graph"><tt class="xref docutils literal"><span class="pre">Graph</span></tt></a> class)
and functions for manipulating that graph, including isomorphism functions.</p>
<div class="section" id="classes-in-rmg-graph">
<h2>4.1. Classes in <tt class="docutils literal"><span class="pre">rmg.graph</span></tt><a class="headerlink" href="#classes-in-rmg-graph" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="rmg.graph.Graph">
<em class="property">
class </em><tt class="descclassname">rmg.graph.</tt><tt class="descname">Graph</tt><a class="headerlink" href="#rmg.graph.Graph" title="Permalink to this definition">¶</a></dt>
<dd><p>A representation of a graph using a dictionary of dictionaries. The keys
of the outer dictionary are the vertices, while edges are accessed via
self[vertex1][vertex2].</p>
<dl class="method">
<dt id="rmg.graph.Graph.addEdge">
<tt class="descname">addEdge</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.addEdge" title="Permalink to this definition">¶</a></dt>
<dd>Add an <cite>edge</cite> to the graph as an edge connecting the two vertices
specified in the 2-tuple <cite>vertices</cite>.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.addVertex">
<tt class="descname">addVertex</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.addVertex" title="Permalink to this definition">¶</a></dt>
<dd>Add a <cite>vertex</cite> to the graph. The vertex is initialized with no edges.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.copy">
<tt class="descname">copy</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.copy" title="Permalink to this definition">¶</a></dt>
<dd>Create a copy of the current graph. The vertices used in both graphs
are the SAME vertices, not copies of each other, so it should not be used
for copying structures (instead do structure.copy())</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.edges">
<tt class="descname">edges</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.edges" title="Permalink to this definition">¶</a></dt>
<dd>Return a list of the edges in the graph.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.findSubgraphIsomorphisms">
<tt class="descname">findSubgraphIsomorphisms</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.findSubgraphIsomorphisms" title="Permalink to this definition">¶</a></dt>
<dd>Returns <tt class="xref xref docutils literal"><span class="pre">True</span></tt> if <cite>other</cite> is subgraph isomorphic and <tt class="xref xref docutils literal"><span class="pre">False</span></tt>
otherwise. Uses the VF2 algorithm of Vento and Foggia.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.getAllCycles">
<tt class="descname">getAllCycles</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.getAllCycles" title="Permalink to this definition">¶</a></dt>
<dd>Given a starting vertex, returns a list of all the cycles containing 
that vertex.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.getEdge">
<tt class="descname">getEdge</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.getEdge" title="Permalink to this definition">¶</a></dt>
<dd>Returns the edge connecting vertices in 2-tuple <cite>vertices</cite>, or None if
no edge exists.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.getEdges">
<tt class="descname">getEdges</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.getEdges" title="Permalink to this definition">¶</a></dt>
<dd>Return a list of the edges involving the specified <cite>vertex</cite>.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.getSmallestSetOfSmallestRings">
<tt class="descname">getSmallestSetOfSmallestRings</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.getSmallestSetOfSmallestRings" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the smallest set of smallest rings in the graph. The
algorithm implements was adapted from a description by Fan, Panaye,
Doucet, and Barbu (doi: 10.1021/ci00015a002)</p>
<p>B. T. Fan, A. Panaye, J. P. Doucet, and A. Barbu. &#8220;Ring Perception: A
New Algorithm for Directly Finding the Smallest Set of Smallest Rings
from a Connection Table.&#8221; <em>J. Chem. Inf. Comput. Sci.</em> <strong>33</strong>, 
p. 657-662 (1993).</p>
</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.hasEdge">
<tt class="descname">hasEdge</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.hasEdge" title="Permalink to this definition">¶</a></dt>
<dd>Returns <tt class="xref xref docutils literal"><span class="pre">True</span></tt> if vertices in the 2-tuple <cite>vertices</cite> are connected
by an edge, and <tt class="xref xref docutils literal"><span class="pre">False</span></tt> if not.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.isIsomorphic">
<tt class="descname">isIsomorphic</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.isIsomorphic" title="Permalink to this definition">¶</a></dt>
<dd>Returns <tt class="xref xref docutils literal"><span class="pre">True</span></tt> if two graphs are isomorphic and <tt class="xref xref docutils literal"><span class="pre">False</span></tt>
otherwise. Uses the VF2 algorithm of Vento and Foggia.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.isSubgraphIsomorphic">
<tt class="descname">isSubgraphIsomorphic</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.isSubgraphIsomorphic" title="Permalink to this definition">¶</a></dt>
<dd>Returns <tt class="xref xref docutils literal"><span class="pre">True</span></tt> if <cite>other</cite> is subgraph isomorphic and <tt class="xref xref docutils literal"><span class="pre">False</span></tt>
otherwise. Uses the VF2 algorithm of Vento and Foggia.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.isVertexInCycle">
<tt class="descname">isVertexInCycle</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.isVertexInCycle" title="Permalink to this definition">¶</a></dt>
<dd>Is <cite>vertex</cite> in a cycle?
Returns <tt class="xref xref docutils literal"><span class="pre">True</span></tt> if it is in a cycle, else <tt class="xref xref docutils literal"><span class="pre">False</span></tt>.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.merge">
<tt class="descname">merge</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.merge" title="Permalink to this definition">¶</a></dt>
<dd>Merge two graphs so as to store them in a single Graph object.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.removeEdge">
<tt class="descname">removeEdge</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.removeEdge" title="Permalink to this definition">¶</a></dt>
<dd>Remove the edge having vertices as specified in the 2-tuple <cite>vertices</cite>
from the graph. Does not remove vertices that no longer have any edges
as a result of this removal.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.removeVertex">
<tt class="descname">removeVertex</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.removeVertex" title="Permalink to this definition">¶</a></dt>
<dd>Remove <cite>vertex1</cite> and all edges associated with it from the graph. Does
not remove vertices that no longer have any edges as a result of this
removal.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.resetCachedStructureInfo">
<tt class="descname">resetCachedStructureInfo</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.resetCachedStructureInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset any cached structural information.</p>
<p>Call this method when you have modified the graph or structure,
so that any information (eg. connectivity values, ring locations) that
we are cacheing, is reset.</p>
</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.setConnectivityValues">
<tt class="descname">setConnectivityValues</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.setConnectivityValues" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the Extended Connectivity values as introduced by Morgan (1965)
<a class="reference external" href="http://dx.doi.org/10.1021/c160017a018">http://dx.doi.org/10.1021/c160017a018</a></p>
<p>First CV1 is the number of neighbours  (Morgan proposed non-Hydrogen neighbours)
CV2 is the sum of neighbouring CV1 values
CV3 is the sum of neighbouring CV2 values</p>
</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.sortAndLabelVertices">
<tt class="descname">sortAndLabelVertices</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.sortAndLabelVertices" title="Permalink to this definition">¶</a></dt>
<dd>Sort the vertices according to <cite>globalAtomSortValue(atom)</cite>,
and record the sorting index on the vertices so they know what order 
they were in. These are stored in <cite>vertex.sorting_label</cite>.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.split">
<tt class="descname">split</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.split" title="Permalink to this definition">¶</a></dt>
<dd>Convert a single Graph object containing two or more unconnected graphs
into separate graphs.</dd></dl>

<dl class="method">
<dt id="rmg.graph.Graph.vertices">
<tt class="descname">vertices</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.Graph.vertices" title="Permalink to this definition">¶</a></dt>
<dd>Return a list of the vertices in the graph.</dd></dl>

</dd></dl>

</div>
<div class="section" id="methods-in-rmg-graph">
<h2>4.2. Methods in <tt class="docutils literal"><span class="pre">rmg.graph</span></tt><a class="headerlink" href="#methods-in-rmg-graph" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="rmg.graph.VF2_isomorphism">
<tt class="descclassname">rmg.graph.</tt><tt class="descname">VF2_isomorphism</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.VF2_isomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <tt class="xref xref docutils literal"><span class="pre">True</span></tt> if two <a title="rmg.graph.Graph" class="reference internal" href="#rmg.graph.Graph"><tt class="xref docutils literal"><span class="pre">Graph</span></tt></a> objects are isomorphic and
<tt class="xref xref docutils literal"><span class="pre">False</span></tt> otherwise. Uses the VF2 algorithm of Vento and Foggia. If
<cite>subgraph</cite> is <tt class="xref xref docutils literal"><span class="pre">True</span></tt> then graph2 is checked for being a potential
subgraph of graph1. <cite>findAll</cite> is used to specify whether all isomorphisms
should be returned,  or only the first.</p>
<p>Returns tuple (is_match, map12, map21)</p>
</dd></dl>

<dl class="function">
<dt id="rmg.graph.__VF2_feasible">
<tt class="descclassname">rmg.graph.</tt><tt class="descname">__VF2_feasible</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.__VF2_feasible" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <tt class="xref xref docutils literal"><span class="pre">True</span></tt> if two vertices <cite>vertex1</cite> and <cite>vertex2</cite> from graphs
<cite>graph1</cite> and <cite>graph2</cite>, respectively, are feasible matches. <cite>mapping21</cite> and
<cite>mapping12</cite> are the current state of the mapping from <cite>graph1</cite> to <cite>graph2</cite>
and vice versa, respectively. <cite>terminals1</cite> and <cite>terminals2</cite> are lists of
the vertices that are directly connected to the already-mapped vertices.
<cite>subgraph</cite> is <tt class="xref xref docutils literal"><span class="pre">True</span></tt> if graph2 is to be treated as a potential
subgraph of graph1.</p>
<p>Uses the VF2 algorithm of Vento and Foggia. The feasibility is assessed
through a series of semantic and structural checks. Only the combination
of the semantic checks and the level 0 structural check are both
necessary and sufficient to ensure feasibility. (This does <em>not</em> mean that
vertex1 and vertex2 are always a match, although the level 1 and level 2
checks preemptively eliminate a number of false positives.)</p>
</dd></dl>

<dl class="function">
<dt id="rmg.graph.__VF2_match">
<tt class="descclassname">rmg.graph.</tt><tt class="descname">__VF2_match</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.__VF2_match" title="Permalink to this definition">¶</a></dt>
<dd><p>A recursive function used to explore two graphs <cite>graph1</cite> and <cite>graph2</cite> for
isomorphism by attempting to map them to one another. <cite>mapping21</cite> and
<cite>mapping12</cite> are the current state of the mapping from <cite>graph1</cite> to <cite>graph2</cite>
and vice versa, respectively. <cite>terminals1</cite> and <cite>terminals2</cite> are lists of
the vertices that are directly connected to the already-mapped vertices.
<cite>subgraph</cite> is <tt class="xref xref docutils literal"><span class="pre">True</span></tt> if graph2 is to be treated as a potential
subgraph of graph1.</p>
<p>Uses the VF2 algorithm of Vento and Foggia, which is O(N) in spatial complexity
and O(N**2) (best-case) to O(N! * N) (worst-case) in temporal complexity.</p>
</dd></dl>

<dl class="function">
<dt id="rmg.graph.__VF2_pairs">
<tt class="descclassname">rmg.graph.</tt><tt class="descname">__VF2_pairs</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.__VF2_pairs" title="Permalink to this definition">¶</a></dt>
<dd>Create a list of pairs of candidates for inclusion in the VF2 mapping. If
there are a nonzero number of terminals in each graph, the candidates are
selected to be one terminal from the first graph and all terminals from the
second graph. If there are no terminals, the candidates are     selected to be
one vertex from the first graph and all vertices from the second graph.</dd></dl>

<dl class="function">
<dt id="rmg.graph.__VF2_terminals">
<tt class="descclassname">rmg.graph.</tt><tt class="descname">__VF2_terminals</tt><big>(</big><big>)</big><a class="headerlink" href="#rmg.graph.__VF2_terminals" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given graph <cite>graph</cite> and associated partial mapping <cite>mapping</cite>,
generate a list of terminals, vertices that are directly connected to
vertices that have already been mapped.</p>
<p>List is sorted (using key=__getSortLabel) before returning.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../static/rmg_logo.png" alt="Logo"/>
            </a></p>
            <h3><a href="../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">4. The <tt class="docutils literal"><span class="pre">rmg.graph</span></tt> Module</a><ul>
<li><a class="reference external" href="#classes-in-rmg-graph">4.1. Classes in <tt class="docutils literal"><span class="pre">rmg.graph</span></tt></a></li>
<li><a class="reference external" href="#methods-in-rmg-graph">4.2. Methods in <tt class="docutils literal"><span class="pre">rmg.graph</span></tt></a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="rmg-data.html"
                                  title="previous chapter">3. The <tt class="docutils literal docutils literal docutils literal"><span class="pre">rmg.data</span></tt> Module</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="rmg-io.html"
                                  title="next chapter">5. The <tt class="docutils literal"><span class="pre">rmg.io</span></tt> Module</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../sources/documentation/api/rmg-graph.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <h3>Other links</h3>
<ul>
<li><a href="http://github.com/GreenGroup/RMG-Py/issues">Issue and Bug Tracker</a></li>
<li><a href="http://github.com/GreenGroup/RMG-Py">Source Code</a> </li>
<!--li><a href="../../RMG-manual.pdf" onClick="javascript: pageTracker._trackPageview('/documentation/RMG-manual.pdf');">View user manual as PDF</a></li-->
<li><a href="http://rmg.sourceforge.net/">RMG-Java on Sourceforge</a></li>
</ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rmg-io.html" title="5. The rmg.io Module"
             >next</a> |</li>
        <li class="right" >
          <a href="rmg-data.html" title="3. The rmg.data Module"
             >previous</a> |</li>
        <li><a href="../../index.html">RMG-Py</a> &raquo;</li>
          <li><a href="../index.html" >RMG Documentation</a> &raquo;</li>
          <li><a href="index.html" >RMG Developer&#8217;s Guide</a> &raquo;</li>
  <li><a href="">4. The <tt class="docutils literal docutils literal"><span class="pre">rmg.graph</span></tt> Module</a></li>

      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, Prof. William H. Green and the RMG Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>