
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>2. The Master Equation &#8212; RMG-Py 3.3.0 Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3. Methods for Determining Phenomenological Rate Coefficients" href="methods.html" />
    <link rel="prev" title="1. Introduction" href="introduction.html" />
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    ce: ["Extension","mhchem"],
  });
});
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="methods.html" title="3. Methods for Determining Phenomenological Rate Coefficients"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="1. Introduction"
             accesskey="P">previous</a> |</li>
  <li><a href="https://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">3.3.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Theory Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Pressure-Dependence Theory Guide</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2. </span>The Master Equation</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="the-master-equation">
<h1><span class="section-number">2. </span>The Master Equation<a class="headerlink" href="#the-master-equation" title="Permalink to this heading">¶</a></h1>
<p>A full treatment of the energy states of each molecule is unfeasible for
molecules larger than diatomics, as there are simply too many states. To
simplify things we apply the RRKM approximation, which leaves the state of a
molecule as a function of two quantities: the total energy <span class="math notranslate nohighlight">\(E\)</span> and total
angular momentum quantum number <span class="math notranslate nohighlight">\(J\)</span>. Frequently we will find that even
this is too difficult, and will only keep the total energy <span class="math notranslate nohighlight">\(E\)</span> as an
independent variable.</p>
<section id="isomers-reactants-and-products">
<h2><span class="section-number">2.1. </span>Isomers, Reactants, and Products<a class="headerlink" href="#isomers-reactants-and-products" title="Permalink to this heading">¶</a></h2>
<p>Throughout this document we will utilize the following terminology:</p>
<ul class="simple">
<li><p>An <strong>isomer</strong> is a unimolecular configuration on the potential energy surface.</p></li>
<li><p>A <strong>reactant channel</strong> is a bimolecular configuration that associates to form
an isomer. Dissociation from the isomer back to reactants is allowed.</p></li>
<li><p>A <strong>product channel</strong> is a bimolecular configuration that is formed by
dissociation of an isomer. Reassociation of products to the isomer is <em>not</em>
allowed.</p></li>
</ul>
<p>The isomers are the configurations for which we must model the energy states.
We designate <span class="math notranslate nohighlight">\(p_i(E, J, t)\)</span> as the population of isomer <span class="math notranslate nohighlight">\(i\)</span> having
total energy <span class="math notranslate nohighlight">\(E\)</span> and total angular momentum quantum number <span class="math notranslate nohighlight">\(J\)</span> at
time <span class="math notranslate nohighlight">\(t\)</span>. At long times, statistical mechanics requires that the
population of each isomer approach a Boltzmann distribution <span class="math notranslate nohighlight">\(b_i(E, J)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\lim_{t \rightarrow \infty} p_i(E, J, t) \propto b_i(E, J)\]</div>
<p>We can simplify by eliminating the angular momentum quantum number to get</p>
<div class="math notranslate nohighlight">
\[p_i(E, t) = \sum_J p_i(E, J, t)\]</div>
<p>Let us also denote the (time-dependent) total population of isomer <span class="math notranslate nohighlight">\(i\)</span>
by <span class="math notranslate nohighlight">\(x_i(t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[x_i(t) \equiv \sum_J \int_0^\infty p_i(E, J, t) \ dE\]</div>
<p>The two molecules of a reactant or product channel are free to move apart from
one another and interact independently with other molecules in the system.
Accordingly, we treat these channels as fully thermalized, leaving as the only
variable the total concentrations <span class="math notranslate nohighlight">\(y_{n\ce{A}}(t)\)</span> and
<span class="math notranslate nohighlight">\(y_{n\ce{B}}(t)\)</span> of the molecules <span class="math notranslate nohighlight">\(\ce{A}_n\)</span> and <span class="math notranslate nohighlight">\(\ce{B}_n\)</span>
of reactant channel <span class="math notranslate nohighlight">\(n\)</span>. (Since the product channels act as infinite
sinks, their populations do not need to be considered explicitly.)</p>
<p>Finally, we will use <span class="math notranslate nohighlight">\(N_\mathrm{isom}\)</span>, <span class="math notranslate nohighlight">\(N_\mathrm{reac}\)</span>, and
<span class="math notranslate nohighlight">\(N_\mathrm{prod}\)</span> as the numbers of isomers, reactant channels, and
product channels, respectively, in the system.</p>
</section>
<section id="collision-models">
<h2><span class="section-number">2.2. </span>Collision Models<a class="headerlink" href="#collision-models" title="Permalink to this heading">¶</a></h2>
<p>Bimolecular collisions with an inert species <span class="math notranslate nohighlight">\(\ce{M}\)</span> are the primary
means by which an isomer molecule changes its energy. A reasonable estimate –
although generally a bit of an underestimate – of the total rate of collisions
<span class="math notranslate nohighlight">\(k_{\mathrm{coll},i}(T)\)</span> for each isomer <span class="math notranslate nohighlight">\(i\)</span> comes from
Lennard-Jones collision theory:</p>
<div class="math notranslate nohighlight">
\[k_{\mathrm{coll},i}(T) = \sqrt{\frac{8 k_\mathrm{B} T}{\pi \mu_i}} \pi d_i^2 \Omega_i^{(2,2)\ast}\]</div>
<p>Above, <span class="math notranslate nohighlight">\(\mu_i\)</span> is the reduced mass, <span class="math notranslate nohighlight">\(d_i\)</span> is the collision diameter,
and <span class="math notranslate nohighlight">\(k_\mathrm{B}\)</span> is the Boltzmann constant. The collision diameter is
generally taken as <span class="math notranslate nohighlight">\(d \approx \frac{1}{2} (\sigma_i + \sigma_{\ce{M}})\)</span>,
the arithmetic average of the Lennard-Jones <span class="math notranslate nohighlight">\(\sigma\)</span> parameter for the
isomer and the bath gas. The parameter <span class="math notranslate nohighlight">\(\Omega_i^{(2,2)\ast}\)</span> represents
a configurational integral, which is well-approximated by the expression</p>
<div class="math notranslate nohighlight">
\[\Omega_i^{(2,2)\ast} = 1.16145 \tilde{T}^{-0.14874} + 0.52487 e^{-0.7732 \tilde{T}}  + 2.16178 e^{-2.437887 \tilde{T}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde{T} \equiv k_\mathrm{B} T / \sqrt{\epsilon_i \epsilon_{\ce{M}}}\)</span>
is a reduced temperature and <span class="math notranslate nohighlight">\(\epsilon_i\)</span> is the Lennard-Jones
<span class="math notranslate nohighlight">\(\epsilon\)</span> parameter. Note that we have used a geometric average for the
<span class="math notranslate nohighlight">\(\epsilon\)</span> parameters of the isomer and the bath gas in this expression.
Assuming the total gas concentration to be constant and that the gas is ideal,
we obtain an expression for the collision frequency <span class="math notranslate nohighlight">\(\omega_i(T,P)\)</span>,
which makes explicit the pressure dependence:</p>
<div class="math notranslate nohighlight">
\[\omega_i(T,P) = k_{\mathrm{coll},i}(T) \frac{P}{k_\mathrm{B} T}\]</div>
<p>Now that we have an estimate for the total rate of collisions, we need to
develop a model of the effect that these collisions have on the state of the
isomer distribution. To this end, we define
<span class="math notranslate nohighlight">\(P(E, J, E^\prime, J^\prime)\)</span> as the probability of a collision
resulting in a transfer of a molecule from state <span class="math notranslate nohighlight">\((E^\prime, J^\prime)\)</span>
to state <span class="math notranslate nohighlight">\((E, J)\)</span>. There are two mathematical constraints on
<span class="math notranslate nohighlight">\(P(E, J, E^\prime, J^\prime)\)</span>. The first of these is normalization:</p>
<div class="math notranslate nohighlight">
\[\sum_{J^\prime} (2 J^\prime + 1) \int_0^\infty P(E, J, E^\prime, J^\prime) \ dE^\prime = 1\]</div>
<p>The second of these is detailed balance, required in order to obtain the
Boltzmann distribution at long times:</p>
<div class="math notranslate nohighlight">
\[P(E, J, E^\prime, J^\prime) b(E^\prime, J^\prime) = P(E^\prime, J^\prime, E, J) b(E, J)\]</div>
<div class="math notranslate nohighlight">
\[P_i(E^\prime, J^\prime, E, J) = \frac{\rho_i(E^\prime, J^\prime)}{\rho_i(E, J)} \exp \left(- \frac{E^\prime - E}{k_\mathrm{B} T} \right) P_i(E, J, E^\prime, J^\prime) \hspace{40pt} E &lt; E^\prime\]</div>
<p>Rather than define models directly for <span class="math notranslate nohighlight">\(P(E, J, E^\prime, J^\prime)\)</span>,
we usually eliminate the angular momentum contribution and instead define
<span class="math notranslate nohighlight">\(P(E, E^\prime)\)</span>. This can be related to
<span class="math notranslate nohighlight">\(P(E, J, E^\prime, J^\prime)\)</span> via</p>
<div class="math notranslate nohighlight">
\[P(E, J, E^\prime, J^\prime) = P(E, E^\prime) \phi(E, J) = P(E, E^\prime) (2J + 1) \frac{\rho(E, J)}{\rho(E)}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho(E) \equiv \sum_J (2J+1) \rho(E, J)\)</span>.</p>
<p>There are a variety of models used for <span class="math notranslate nohighlight">\(P(E, E^\prime)\)</span>.
By far the most common is the single exponential down model</p>
<div class="math notranslate nohighlight">
\[P(E, E^\prime) = C(E^\prime) \exp \left( -\frac{E^\prime - E}{\alpha} \right) \hspace{40pt} E &lt; E^\prime\]</div>
<p>where <span class="math notranslate nohighlight">\(C(E^\prime)\)</span> is determined from the normalization constraint. Note
that this function has been defined for the deactivating direction
(<span class="math notranslate nohighlight">\(E &lt; E^\prime\)</span>) only, as the activating direction (<span class="math notranslate nohighlight">\(E &gt; E^\prime\)</span>)
is then set from detailed balance. The parameter <span class="math notranslate nohighlight">\(\alpha\)</span> corresponds to
the average energy transferred in a deactivating collision
<span class="math notranslate nohighlight">\(\left&lt; \Delta E_\mathrm{d} \right&gt;\)</span>, which itself is a weak function of
temperature.</p>
<p>Other models for <span class="math notranslate nohighlight">\(P(E, J, E^\prime, J^\prime)\)</span> include the Gaussian down</p>
<div class="math notranslate nohighlight">
\[P(E, E^\prime) = C(E^\prime) \exp \left[ - \frac{(E^\prime - E)^2}{\alpha^2} \right] \hspace{40pt} E &lt; E^\prime\]</div>
<p>and the double exponential down</p>
<div class="math notranslate nohighlight">
\[P(E, E^\prime) = C(E^\prime) \left[ (1 - f) \exp \left( -\frac{E^\prime - E}{\alpha_1} \right) + f \exp \left( -\frac{E^\prime - E}{\alpha_2} \right) \right] \hspace{40pt} E &lt; E^\prime\]</div>
<p>The parameters for these simple models generally contain so much uncertainty
that more complex functional forms are generally not used.</p>
</section>
<section id="reaction-models">
<h2><span class="section-number">2.3. </span>Reaction Models<a class="headerlink" href="#reaction-models" title="Permalink to this heading">¶</a></h2>
<p>Chemical reaction events cause a change in molecular configuration at constant
energy. The rate coefficient for this process must be determined as a function
of energy rather than the usual temperature. Such a quantity is called a
<em>microcanonical rate coefficient</em> and written as <span class="math notranslate nohighlight">\(k(E, J)\)</span>. In the master
equation we will differentiate between microcanonical rate coefficients for
isomerization, dissociation, and association by using different letters:
<span class="math notranslate nohighlight">\(k_{ij}(E, J)\)</span> for isomerization, <span class="math notranslate nohighlight">\(g_{nj}(E, J)\)</span> for dissociation,
and <span class="math notranslate nohighlight">\(f_{im}(E, J)\)</span> for association. (By convention, we use indices
<span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> to refer to unimolecular isomers, <span class="math notranslate nohighlight">\(m\)</span> and
<span class="math notranslate nohighlight">\(n\)</span> to refer to bimolecular reactant and product channels, and, later,
<span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(s\)</span> to refer to energy grains.)</p>
<p>As with collision models, the values of the microcanonical rate coefficients
are constrained by detailed balance so that the proper equilibrium is
obtained. The detailed balance expressions have the form</p>
<div class="math notranslate nohighlight">
\[k_{ij}(E, J) \rho_j(E, J) = k_{ji}(E, J) \rho_i(E, J)\]</div>
<p>for isomerization and</p>
<div class="math notranslate nohighlight">
\[f_{in}(E, J) \rho_n(E, J) = g_{ni}(E, J) \rho_i(E, J)\]</div>
<p>for association/dissociation, where <span class="math notranslate nohighlight">\(\rho_i(E, J)\)</span> is the density of
states of the appropriate unimolecular or bimolecular configuration.</p>
<p>An alternative formulation incorporates the macroscopic equilibrium coefficient
<span class="math notranslate nohighlight">\(K_\mathrm{eq}(T)\)</span> and equilibrium distributions <span class="math notranslate nohighlight">\(b_i(E, J, T)\)</span> at
each temperature:</p>
<div class="math notranslate nohighlight">
\[k_{ij}(E, J) b_j(E, J, T) = K_\mathrm{eq}(T) k_{ji}(E, J) b_i(E, J, T)\]</div>
<p>for isomerization and</p>
<div class="math notranslate nohighlight">
\[f_{in}(E, J) b_n(E, J, T) = K_\mathrm{eq}(T) g_{ni}(E, J) b_i(E, J, T)\]</div>
<p>for association/dissociation. Note that these two formulations are equivalent if
the molecular degrees of freedom are consistent with the macroscopic
thermodynamic parameters. There are multiple reasons to use the latter
formulation:</p>
<ul class="simple">
<li><p>Only the density of states of the unimolecular isomers need be computed. This
is a result of the assumption of thermalized bimolecular channels, which
means that we only need to compute the product <span class="math notranslate nohighlight">\(f_{in} b_n\)</span>, and not
the individual values of <span class="math notranslate nohighlight">\(f_{in}\)</span> and <span class="math notranslate nohighlight">\(b_n\)</span>.</p></li>
<li><p>Only the reactive rovibrational modes need be included in the density of
states. Missing modes will not affect the observed equilibrium because we are
imposing the macroscopic equilibrium via <span class="math notranslate nohighlight">\(K_\mathrm{eq}(T)\)</span>.</p></li>
<li><p>Constants of proportionality in the density of states become unimportant, as
they cancel when taking the ratio <span class="math notranslate nohighlight">\(\rho(E,J)/Q(\beta)\)</span>. For example, if
the external rotational constants are unknown then we will include an active
K-rotor in the density of states; this property means that the rotational
constant of this active K-rotor cancels and is therefore arbitrary.</p></li>
</ul>
<p>There are two common ways of determining values for <span class="math notranslate nohighlight">\(k(E, J)\)</span>: the
inverse Laplace transform method and RRKM theory. The latter requires detailed
information about the transition state, while the former only requires the
high-pressure limit rate coefficient <span class="math notranslate nohighlight">\(k_\infty(T)\)</span>.</p>
<section id="inverse-laplace-transform">
<h3><span class="section-number">2.3.1. </span>Inverse Laplace Transform<a class="headerlink" href="#inverse-laplace-transform" title="Permalink to this heading">¶</a></h3>
<p>The microcanonical rate coefficient <span class="math notranslate nohighlight">\(k(E)\)</span> is related to the canonical
high-pressure limit rate coefficient <span class="math notranslate nohighlight">\(k_\infty(T)\)</span> via a Boltzmann
averaging</p>
<div class="math notranslate nohighlight">
\[k_\infty(T) = \frac{\sum_J \int_0^\infty k(E) \rho(E, J) e^{-\beta E} \ dE}{\sum_J \int_0^\infty \rho(E, J) e^{-\beta E} \ dE}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho(E, J)\)</span> is the rovibrational density of states for the
reactants and <span class="math notranslate nohighlight">\(\beta \equiv (k_\mathrm{B} T)^{-1}\)</span>. Neglecting the
angular momentum dependence, the above can be written in terms of Laplace
transforms as</p>
<div class="math notranslate nohighlight">
\[k_\infty(T) = \frac{\mathcal{L} \left[ k(E) \rho(E) \right]} {\mathcal{L} \left[ \rho(E) \right]} = \frac{\mathcal{L} \left[ k(E) \rho(E) \right]} {Q(\beta)}\]</div>
<p>where <span class="math notranslate nohighlight">\(Q(\beta)\)</span> is the rovibrational partition function for the
reactants. The above implies that <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> are the transform
variables. We can take an inverse Laplace transform in order to solve for
<span class="math notranslate nohighlight">\(k(E)\)</span>:</p>
<div class="math notranslate nohighlight">
\[k(E) = \frac{\mathcal{L}^{-1} \left[ k_\infty(\beta) Q(\beta) \right] }{\rho(E)}\]</div>
<p>Hidden in the above manipulation is the assumption that <span class="math notranslate nohighlight">\(k_\infty(\beta)\)</span>
is valid over a temperature range from zero to positive infinity.</p>
<p>The most common form of <span class="math notranslate nohighlight">\(k_\infty(T)\)</span> is the modified Arrhenius expression</p>
<div class="math notranslate nohighlight">
\[k(T) = A T^n \exp \left( - \frac{E_\mathrm{a}}{k_\mathrm{B} T} \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(n\)</span>, and <span class="math notranslate nohighlight">\(E_\mathrm{a}\)</span> are the Arrhenius
preexpoential, temperature exponent, and activation energy, respectively. For
<span class="math notranslate nohighlight">\(n = 0\)</span> and <span class="math notranslate nohighlight">\(E_\mathrm{a} &gt; 0\)</span> the inverse Laplace transform can be
easily evaluated to give</p>
<div class="math notranslate nohighlight">
\[k(E) = A \frac{\rho(E - E_\mathrm{a})}{\rho(E)} \hspace{40pt} E &gt; E_\mathrm{a}\]</div>
<p>We can also determine an expression when <span class="math notranslate nohighlight">\(n &gt; 0\)</span> and
<span class="math notranslate nohighlight">\(E_\mathrm{a} &gt; 0\)</span> using a convolution integral:</p>
<div class="math notranslate nohighlight">
\[k(E) = A \frac{\phi(E - E_\mathrm{a})}{\rho(E)} \hspace{40pt} E &gt; E_\mathrm{a}\]</div>
<div class="math notranslate nohighlight">
\[\phi(E) = \mathcal{L}^{-1} \left[ T^n Q(\beta) \right] = \frac{1}{k_\mathrm{B}^n \Gamma(n)} \int_0^E (E - x)^{n-1} \rho(x) \ dx\]</div>
<p>Finally, for cases where <span class="math notranslate nohighlight">\(n &lt; 0\)</span> and/or <span class="math notranslate nohighlight">\(E_\mathrm{a} &lt; 0\)</span> we
obtain a rough estimate by lumping these contributions into the preexponential
at the temperature we are working at. By redoing this at each temperature being
considered we minimize the error introduced, at the expense of not being able
to identify a single <span class="math notranslate nohighlight">\(k(E)\)</span>.</p>
</section>
<section id="rrkm-theory">
<h3><span class="section-number">2.3.2. </span>RRKM Theory<a class="headerlink" href="#rrkm-theory" title="Permalink to this heading">¶</a></h3>
<p>RRKM theory – named for Rice, Ramsperger, Kassel, and Marcus – is a
microcanonical transition state theory. Like canonical transition state theory,
detailed information about the transition state and reactants are required,
e.g. from a quantum chemistry calculation. If such information is available,
then the microcanonical rate coefficient can be evaluated via the equation</p>
<div class="math notranslate nohighlight">
\[k(E, J) = \frac{N^\ddagger(E, J)}{h \rho(E, J)}\]</div>
<p>where <span class="math notranslate nohighlight">\(N^\ddagger(E, J)\)</span> is the sum of states of the transition state,
<span class="math notranslate nohighlight">\(\rho(E, J)\)</span> is the density of states of the reactant, and <span class="math notranslate nohighlight">\(h\)</span> is
the Planck constant. Both the transition state and the reactants have been
referenced to the same zero of energy. The sum of states is related to the
density of states via</p>
<div class="math notranslate nohighlight">
\[N(E, J) = \int_0^E \rho(x, J) \ dx\]</div>
<p>The angular momentum quantum number dependence can be removed via</p>
<div class="math notranslate nohighlight">
\[k(E) = \sum_J (2J+1) k(E, J)\]</div>
</section>
</section>
<section id="the-full-master-equation">
<h2><span class="section-number">2.4. </span>The Full Master Equation<a class="headerlink" href="#the-full-master-equation" title="Permalink to this heading">¶</a></h2>
<p>The governing equation for the population distributions <span class="math notranslate nohighlight">\(p_i(E, J, t)\)</span>
of each isomer <span class="math notranslate nohighlight">\(i\)</span> and the reactant concentrations
<span class="math notranslate nohighlight">\(y_{n\mathrm{A}}(t)\)</span> and <span class="math notranslate nohighlight">\(y_{n\mathrm{B}}(t)\)</span> combines the
collision and reaction models to give a linear integro-differential equation:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}\frac{d}{dt} p_i(E, J, t) &amp;= \omega_i(T, P) \sum_{J^\prime} \int_0^\infty P_i(E, J, E^\prime, J^\prime) p_i(E^\prime, J^\prime, t) \ dE^\prime - \omega_i(T, P) p_i(E, J, t) \\
                       &amp;  \mbox{} + \sum_{j \ne i}^{N_\mathrm{isom}} k_{ij}(E, J) p_j(E, J, t) - \sum_{j \ne i}^{N_\mathrm{isom}} k_{ji}(E, J) p_i(E, J, t) \\
                       &amp;  \mbox{} + \sum_{n=1}^{N_\mathrm{reac}} y_{n\mathrm{A}}(t) y_{n\mathrm{B}}(t) f_{in}(E, J) b_n(E, J, t) - \sum_{n=1}^{N_\mathrm{reac} + N_\mathrm{prod}} g_{ni}(E, J) p_i(E, J, t) \\\end{split}\\\begin{split}\frac{d}{dt} y_{n\mathrm{A}}(t) = \frac{d}{dt} y_{n\mathrm{B}}(t) &amp;= \sum_{i=1}^{N_\mathrm{isom}} \int_0^\infty g_{ni}(E, J) p_i(E, J, t) \ dE \\
                                                                  &amp;  \mbox{} - \sum_{i=1}^{N_\mathrm{isom}} y_{n\mathrm{A}}(t) y_{n\mathrm{B}}(t) \int_0^\infty f_{in}(E, J) b_n(E, J, t) \  dE\end{split}\end{aligned}\end{align} \]</div>
<p>A summary of the variables is given below:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(p_i(E, J, t)\)</span></p></td>
<td><p>Population distribution of isomer <span class="math notranslate nohighlight">\(i\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(y_{n\mathrm{A}}(t)\)</span></p></td>
<td><p>Total population of species <span class="math notranslate nohighlight">\(\ce{A}_n\)</span> in reactant channel <span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\omega_i(T, P)\)</span></p></td>
<td><p>Collision frequency of isomer <span class="math notranslate nohighlight">\(i\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(P_i(E, J, E^\prime, J^\prime)\)</span></p></td>
<td><p>Collisional transfer probability from <span class="math notranslate nohighlight">\((E^\prime, J^\prime)\)</span> to <span class="math notranslate nohighlight">\((E, J)\)</span> for isomer <span class="math notranslate nohighlight">\(i\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k_{ij}(E, J)\)</span></p></td>
<td><p>Microcanonical rate coefficient for isomerization from isomer <span class="math notranslate nohighlight">\(j\)</span> to isomer <span class="math notranslate nohighlight">\(i\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(f_{im}(E, J)\)</span></p></td>
<td><p>Microcanonical rate coefficient for association from reactant channel <span class="math notranslate nohighlight">\(m\)</span> to isomer <span class="math notranslate nohighlight">\(i\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(g_{nj}(E, J)\)</span></p></td>
<td><p>Microcanonical rate coefficient for dissociation from isomer <span class="math notranslate nohighlight">\(j\)</span> to reactant or product channel <span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(b_n(E, J, t)\)</span></p></td>
<td><p>Boltzmann distribution for reactant channel <span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(N_\mathrm{isom}\)</span></p></td>
<td><p>Total number of isomers</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N_\mathrm{reac}\)</span></p></td>
<td><p>Total number of reactant channels</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(N_\mathrm{prod}\)</span></p></td>
<td><p>Total number of product channels</p></td>
</tr>
</tbody>
</table>
<p>The above is called the two-dimensional master equation because it contains two
dimensions: total energy <span class="math notranslate nohighlight">\(E\)</span> and total angular momentum quantum number
<span class="math notranslate nohighlight">\(J\)</span>. In the first equation (for isomers), the first pair of terms
correspond to collision, the second pair to isomerization, and the final pair
to association/dissociation. Similarly, in the second equation above (for
reactant channels), the pair of terms refer to dissociation/association.</p>
<p>We can also simplify the above to the one-dimensional form, which
only has <span class="math notranslate nohighlight">\(E\)</span> as a dimension:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}\frac{d}{dt} p_i(E, t) &amp;= \omega_i(T, P) \int_0^\infty P_i(E, E^\prime) p_i(E^\prime, t) \ dE^\prime - \omega_i(T, P) p_i(E, t) \\
                       &amp;  \mbox{} + \sum_{j \ne i}^{N_\mathrm{isom}} k_{ij}(E) p_j(E, t) - \sum_{j \ne i}^{N_\mathrm{isom}} k_{ji}(E) p_i(E, t) \\
                       &amp;  \mbox{} + \sum_{n=1}^{N_\mathrm{reac}} y_{n\mathrm{A}}(t) y_{n\mathrm{B}}(t) f_{in}(E) b_n(E, t) - \sum_{n=1}^{N_\mathrm{reac} + N_\mathrm{prod}} g_{ni}(E) p_i(E, t) \\\end{split}\\\begin{split}\frac{d}{dt} y_{n\mathrm{A}}(t) = \frac{d}{dt} y_{n\mathrm{B}}(t) &amp;= \sum_{i=1}^{N_\mathrm{isom}} \int_0^\infty g_{ni}(E) p_i(E, t) \ dE \\
                                                                  &amp;  \mbox{} - \sum_{i=1}^{N_\mathrm{isom}} y_{n\mathrm{A}}(t) y_{n\mathrm{B}}(t) \int_0^\infty f_{in}(E) b_n(E, t) \ dE\end{split}\end{aligned}\end{align} \]</div>
<p>The equations as given are nonlinear, both due to the presence of the
bimolecular reactants and because both <span class="math notranslate nohighlight">\(\omega_i\)</span> and
<span class="math notranslate nohighlight">\(P_i(E, E^\prime)\)</span> depend on the composition, which is changing with time.
The rate coefficients can be derived from considering the pseudo-first-order
situation where <span class="math notranslate nohighlight">\(y_{n\mathrm{A}}(t) \ll y_{n\mathrm{B}}(t)\)</span>, and all
<span class="math notranslate nohighlight">\(y(t)\)</span> are negligible compared to the bath gas <span class="math notranslate nohighlight">\(\ce{M}\)</span>. From these
assumptions the changes in <span class="math notranslate nohighlight">\(\omega_i\)</span>, <span class="math notranslate nohighlight">\(P_i(E, E^\prime)\)</span>, and all
<span class="math notranslate nohighlight">\(y_{n\mathrm{B}}\)</span> can be neglected, which yields a linear equation system.</p>
</section>
<section id="the-energy-grained-master-equation">
<h2><span class="section-number">2.5. </span>The Energy-Grained Master Equation<a class="headerlink" href="#the-energy-grained-master-equation" title="Permalink to this heading">¶</a></h2>
<p>Except for the simplest of unimolecular reaction networks, both the
one-dimensional and two-dimensional master equation must be solved numerically.
To do this we must discretize and truncate the energy domain into a finite
number of discrete bins called <em>grains</em>. This converts the linear
integro-differential equation into a system of first-order ordinary
differential equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\renewcommand{\vector}[1]{\boldsymbol{\mathbf{#1}}}
\renewcommand{\matrix}[1]{\boldsymbol{\mathbf{#1}}}
\frac{d}{dt} \begin{bmatrix}
\vector{p}_1 \\
\vector{p}_2 \\
\vdots \\
y_{1\mathrm{A}} \\
y_{2\mathrm{A}} \\
\vdots
\end{bmatrix} = \begin{bmatrix}
\matrix{M}_1 &amp; \matrix{K}_{12} &amp; \ldots &amp; \matrix{F}_{11} \vector{b}_1 y_{1\mathrm{B}} &amp; \matrix{F}_{12} \vector{b}_2 y_{2\mathrm{B}} &amp; \ldots \\
\matrix{K}_{21} &amp; \matrix{M}_2 &amp; \ldots &amp; \matrix{F}_{21} \vector{b}_1 y_{1\mathrm{B}} &amp; \matrix{F}_{22} \vector{b}_2 y_{2\mathrm{B}} &amp; \ldots \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \ddots \\
(\vector{g}_{11})^T &amp; (\vector{g}_{12})^T &amp; \ldots &amp; h_1 &amp; 0 &amp; \ldots \\
(\vector{g}_{21})^T &amp; (\vector{g}_{22})^T &amp; \ldots &amp; 0 &amp; h_2 &amp; \ldots \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \ddots
\end{bmatrix} \begin{bmatrix}
\vector{p}_1 \\
\vector{p}_2 \\
\vdots \\
y_{1\mathrm{A}} \\
y_{2\mathrm{A}} \\
\vdots
\end{bmatrix}\end{split}\]</div>
<p>The diagonal matrices <span class="math notranslate nohighlight">\(\matrix{K}_{ij}\)</span> and <span class="math notranslate nohighlight">\(\matrix{F}_{in}\)</span> and
the vector <span class="math notranslate nohighlight">\(\vector{g}_{ni}\)</span> contain the microcanonical rate coefficients
for isomerization, association, and dissociation, respectively:</p>
<div class="math notranslate nohighlight">
\[\begin{split}(\matrix{K}_{ij})_{rs} &amp;= \begin{cases}
\frac{1}{\Delta E_r} \int_{E_r - \Delta E_r/2}^{E_r + \Delta E_r/2} k_{ij}(E) \, dE &amp; r = s \\
0 &amp; r \ne s
\end{cases} \\
(\matrix{F}_{in})_{rs} &amp;= \begin{cases}
\frac{1}{\Delta E_r} \int_{E_r - \Delta E_r/2}^{E_r + \Delta E_r/2} f_{in}(E) \, dE &amp; r = s \\
0 &amp; r \ne s
\end{cases} \\
(\matrix{g}_{ni})_r &amp;= \frac{1}{\Delta E_r} \int_{E_r - \Delta E_r/2}^{E_r + \Delta E_r/2} g_{ni}(E) \, dE\end{split}\]</div>
<p>The matrices <span class="math notranslate nohighlight">\(\matrix{M}_i\)</span> represent the collisional transfer
probabilities minus the rates of reactive loss to other isomers and to
reactants and products:</p>
<div class="math notranslate nohighlight">
\[\begin{split}(\matrix{M}_i)_{rs} = \begin{cases}
\omega_i \left[ P_i(E_r, E_r) - 1 \right] - \sum_{j \ne i}^{N_\mathrm{isom}} k_{ij}(E_r) - \sum_{n=1}^{N_\mathrm{reac} + N_\mathrm{prod}} g_{ni}(E_r) &amp; r = s \\
\omega_i P_i(E_r, E_s) &amp; r \ne s
\end{cases}\end{split}\]</div>
<p>The scalars <span class="math notranslate nohighlight">\(h_n\)</span> are simply the total rate coefficient for loss of
reactant channel <span class="math notranslate nohighlight">\(n\)</span> due to chemical reactions:</p>
<div class="math notranslate nohighlight">
\[h_n = - \sum_{i=1}^{N_\mathrm{isom}} \sum_{r=1}^{N_\mathrm{grains}} y_{n\mathrm{B}} f_{in}(E_r) b_n(E_r)\]</div>
</section>
<section id="further-reading">
<h2><span class="section-number">2.6. </span>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this heading">¶</a></h2>
<p>The interested reader is referred to any of a variety of other sources for
alternative presentations, of which an illustrative sampling is given here
<a class="reference internal" href="#gilbert1990" id="id1"><span>[Gilbert1990]</span></a> <a class="reference internal" href="#baer1996" id="id2"><span>[Baer1996]</span></a> <a class="reference internal" href="#holbrook1996" id="id3"><span>[Holbrook1996]</span></a> <a class="reference internal" href="#forst2003" id="id4"><span>[Forst2003]</span></a> <a class="reference internal" href="#pilling2003" id="id5"><span>[Pilling2003]</span></a>.</p>
<div role="list" class="citation-list">
<div class="citation" id="gilbert1990" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Gilbert1990</a><span class="fn-bracket">]</span></span>
<p>R. G. Gilbert and S. C. Smith. <em>Theory of Unimolecular and
Recombination Reactions</em>. Blackwell Sci. (1990).</p>
</div>
<div class="citation" id="baer1996" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">Baer1996</a><span class="fn-bracket">]</span></span>
<p>T. Baer and W. L. Hase. <em>Unimolecular Reaction Dynamics</em>.
Oxford University Press (1996).</p>
</div>
<div class="citation" id="holbrook1996" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">Holbrook1996</a><span class="fn-bracket">]</span></span>
<p>K. A. Holbrook, M. J. Pilling, and S. H. Robertson.
<em>Unimolecular Reactions</em>. Second Edition. John Wiley and Sons (1996).</p>
</div>
<div class="citation" id="forst2003" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">Forst2003</a><span class="fn-bracket">]</span></span>
<p>W. Forst. <em>Unimolecular Reactions: A Concise Introduction</em>.
Cambridge University Press (2003).</p>
</div>
<div class="citation" id="pilling2003" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">Pilling2003</a><span class="fn-bracket">]</span></span>
<p>M. J. Pilling and S. H. Robertson. <em>Annu. Rev. Phys. Chem.</em>
<strong>54</strong>, p. 245-275 (2003).
<a class="reference external" href="https://doi.org/10.1146/annurev.physchem.54.011002.103822">doi:10.1146/annurev.physchem.54.011002.103822</a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
  <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
    <div class="sphinxsidebarwrapper">
        <div class="sidebarlogo"><a href="../../index.html">
            <img src="../../_static/rmg-logo-small.png" alt="RMG" />
        </a></div>
      <div id="sidebar">
        <div id="rmgsidebar">
          <a href="https://rmg.mit.edu">
            <div class="menuitem">
              <img src="../../_static/rmg-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG Website</div>
              <div class="menutext menudesc">Interactive website for RMG-Py</div>
            </div>
          </a>
          <a href="https://github.com/ReactionMechanismGenerator/RMG-Py">
            <div class="menuitem">
              <img src="../../_static/github-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG GitHub</div>
              <div class="menutext menudesc">View source and post issues</div>
            </div>
          </a>
        </div>
        <div class="menuitem">
  <div>
    <h3><a href="../../contents.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">2. The Master Equation</a><ul>
<li><a class="reference internal" href="#isomers-reactants-and-products">2.1. Isomers, Reactants, and Products</a></li>
<li><a class="reference internal" href="#collision-models">2.2. Collision Models</a></li>
<li><a class="reference internal" href="#reaction-models">2.3. Reaction Models</a><ul>
<li><a class="reference internal" href="#inverse-laplace-transform">2.3.1. Inverse Laplace Transform</a></li>
<li><a class="reference internal" href="#rrkm-theory">2.3.2. RRKM Theory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-full-master-equation">2.4. The Full Master Equation</a></li>
<li><a class="reference internal" href="#the-energy-grained-master-equation">2.5. The Energy-Grained Master Equation</a></li>
<li><a class="reference internal" href="#further-reading">2.6. Further Reading</a></li>
</ul>
</li>
</ul>

  </div>
        </div>
        <div class="menuitem">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="introduction.html"
                          title="previous chapter"><span class="section-number">1. </span>Introduction</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="methods.html"
                          title="next chapter"><span class="section-number">3. </span>Methods for Determining Phenomenological Rate Coefficients</a></p>
  </div>
        </div>
        <div class="menuitem">
<div role="note" aria-label="source link">
    <h3>This Page</h3>
        <ul class="this-page-menu">
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/issues">Report A Bug</a></li>
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/blob/main/documentation/source/theory/pdep/master_equation.rst"
                   rel="nofollow">View Source</a></li>
        </ul>
</div>
        </div>
        <div class="menuitem">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="methods.html" title="3. Methods for Determining Phenomenological Rate Coefficients"
             >next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="1. Introduction"
             >previous</a> |</li>
  <li><a href="https://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">3.3.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Theory Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Pressure-Dependence Theory Guide</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2. </span>The Master Equation</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2002-2025, William H. Green, Richard H. West, and the RMG Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-24556433-3");
    pageTracker._trackPageview();
  } catch(err) {}
</script>

  </body>
</html>