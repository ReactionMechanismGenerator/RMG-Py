
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>1. Rate-based Model Enlarging Algorithm &#8212; RMG-Py 3.0.0 Documentation</title>
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Prune Edge Species" href="prune.html" />
    <link rel="prev" title="RMG Theory Guide" href="index.html" />
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    ce: ["Extension","mhchem"],
  });
});
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="prune.html" title="2. Prune Edge Species"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="RMG Theory Guide"
             accesskey="P">previous</a> |</li>
  <li><a href="http://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">3.0.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Theory Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">RMG Theory Guide</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="rate-based-model-enlarging-algorithm">
<span id="ratebasedmodelenlarger"></span><h1><span class="section-number">1. </span>Rate-based Model Enlarging Algorithm<a class="headerlink" href="#rate-based-model-enlarging-algorithm" title="Permalink to this headline">¶</a></h1>
<div class="figure align-default">
<img alt="../../_images/fluxAlgorithm.png" src="../../_images/fluxAlgorithm.png" />
</div>
<p>To construct a mechanism, the user must specify an initial set of species and
the initial conditions (temperature, pressure, species concentrations, etc.).
RMG reacts the initial species in all possible ways according to its known
reaction families, and it integrates the model in time. RMG tracks the rate
(flux) at which each new “edge” species is produced, and species (and the
reactions producing them) that are produced with significant fluxes are
incorporated into the model (the “core”). These new core species are reacted
with all other core species in the model to generate a new set of edge species
and reactions. The time-integration restarts, and the expanded list of edge
species is monitored for significant species to be included in the core. The
process continues until all significant species and reactions have been
included in the model. The definition of a “significant” rate can be specified by the user
by taking the following definition for a single species rate:</p>
<p><span class="math notranslate nohighlight">\(R_i = \frac{dC_i}{dt}\)</span></p>
<p>and the following definition for the reaction system’s characteristic rate, which is the sum of
all <strong>core</strong> species rates:</p>
<p><span class="math notranslate nohighlight">\(R_{char} = \sqrt{\sum\limits_{j} R_{j}^2}\quad    \quad  \textrm{species $j$ $\in$  core}\)</span></p>
<p>When a <span class="math notranslate nohighlight">\(\textrm{species $i$ $\in$ edge}\)</span>  exceeds a “significant” rate equal to <span class="math notranslate nohighlight">\(\epsilon R_{char}\)</span>,
it is added to the core. The parameter <span class="math notranslate nohighlight">\(\epsilon\)</span> is the user-specified
<code class="docutils literal notranslate"><span class="pre">toleranceMoveToCore</span></code> that can be adjusted under the <a class="reference internal" href="../../users/rmg/input.html#modeltolerances"><span class="std std-ref">model tolerances</span></a>
in the <a class="reference internal" href="../../users/rmg/input.html#input"><span class="std std-ref">RMG Input File</span></a>.</p>
<p>For more information on rate-based model enlargement, please refer to the papers <a class="reference internal" href="../../users/rmg/input.html#gao2016" id="id1"><span>[Gao2016]</span></a> or <a class="reference internal" href="#susnow1997" id="id2"><span>[Susnow1997]</span></a>.</p>
<dl class="citation">
<dt class="label" id="gao2016"><span class="brackets"><a class="fn-backref" href="#id1">Gao2016</a></span></dt>
<dd><p>C. W. Gao, J. W. Allen, W. H. Green, R. H. West, “Reaction Mechanism Generator: automatic construction of chemical kinetic mechanisms.” <em>Computer Physics Communications</em> (2016).</p>
</dd>
<dt class="label" id="susnow1997"><span class="brackets"><a class="fn-backref" href="#id2">Susnow1997</a></span></dt>
<dd><p>R. G. Susnow, A. M. Dean, W. H. Green, P. K. Peczak, and L. J. Broadbelt. “Rate-Based Construction of Kinetic Models for Complex Systems.” <em>J. Phys. Chem. A</em> <strong>101</strong>, p. 3731-3740 (1997).</p>
</dd>
</dl>
<div class="section" id="filtering-reactions-within-the-rate-based-algorithm">
<span id="filterreactionstheory"></span><h2><span class="section-number">1.1. </span>Filtering Reactions within the Rate-based Algorithm<a class="headerlink" href="#filtering-reactions-within-the-rate-based-algorithm" title="Permalink to this headline">¶</a></h2>
<p>Filtering reactions in the react step in the flux-based algorithm attempts to speed up model generation by attacking the pain point.  RMG has trouble
converging when generating models for large molecules because it searches for reactions on the order of <span class="math notranslate nohighlight">\((n_{reaction\: sites})^{{n_{species}}}\)</span>.</p>
<p>The original algorithm performs in the following manner:</p>
<ol class="arabic simple">
<li><p>Reacts species together (slow)</p></li>
<li><p>Determines which reactions are negligible (fast)</p></li>
</ol>
<p>By filtering reactions we add a pre-filtering step before step 1 which prevents species from reacting together when the reactions are expected to be negligible
throughout the simulation.</p>
<div class="figure align-default">
<img alt="../../_images/fluxAlgorithmWithReactionFiltering.png" src="../../_images/fluxAlgorithmWithReactionFiltering.png" />
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">unimolecularThreshold</span></code>, <code class="docutils literal notranslate"><span class="pre">bimolecularThreshold</span></code>, and <code class="docutils literal notranslate"><span class="pre">trimolecularThreshold</span></code> are binary arrays storing flags for whether a species or a pair of species are above a reaction threshold.
For a unimolecular rate, this threshold is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if the unimolecular rate of <span class="math notranslate nohighlight">\(\textrm{reaction $k$}\)</span> for a species A</p>
<p><span class="math notranslate nohighlight">\(R_{unimolecular} = k_{threshold}C_A &gt; \epsilon R_{char}\)</span></p>
<p>at any given time <span class="math notranslate nohighlight">\(t\)</span> in the reaction system, where <span class="math notranslate nohighlight">\(k_{threshold} = \frac{k_B T}{h}\)</span></p>
<p>For a bimolecular reaction occuring between species A and B, this threshold is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if the bimolecular rate</p>
<p><span class="math notranslate nohighlight">\(R_{bimolecular} = k_{threshold}C_A C_B &gt; \epsilon R_{char}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(k_{threshold} = filterThreshold\)</span>. <code class="docutils literal notranslate"><span class="pre">filterThreshold</span></code> is set by the user in the input file and its
default value is <span class="math notranslate nohighlight">\(10^{8} \frac{m^3}{mol\cdot s}\)</span>. This is on the same order of magnitude as the collision limit for two hydrogen atoms
at 1000 K. In general, it is recommended to set <code class="docutils literal notranslate"><span class="pre">filterThreshold</span></code> such that <span class="math notranslate nohighlight">\(k_{threshold}\)</span> is slightly greater
than the maximum rate constants one expects to be present in the system of interest. This will ensure that very fast
reactions are not accidentally filtered out.</p>
<p>Similarly, for a trimolecular reaction, the following expression is used:</p>
<p><span class="math notranslate nohighlight">\(R_{trimolecular} = k_{threshold}C_A C_B C_C &gt; \epsilon R_{char}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(k_{threshold} = 10^{-3} \cdot filterThreshold \frac{m^6}{mol^2\cdot s}\)</span>.
Based on extending Smoluchowski theory to multiple molecules, the diffusion limit rate constant for trimolecular
reactions (in <span class="math notranslate nohighlight">\(\frac{m^6}{mol^2\cdot s}\)</span>) is approximately three orders of magnitude smaller than the rate
constant for bimolecular reactions (in <span class="math notranslate nohighlight">\(\frac{m^3}{mol\cdot s}\)</span>). It is assumed here that Smoluchowski theory
gives a sufficient approximation to collision theory in the gas phase.</p>
<p>When the liquid-phase reactor is used, the diffusion limits are calculated using the Stokes-Einstein equation instead.
For bimolecular reactions, this results in</p>
<p><span class="math notranslate nohighlight">\(k_{threshold}[m^3/mol/s] = 22.2\frac{T[K]}{\mu[Pa\cdot s]}\)</span></p>
<p>and for trimolecular</p>
<p><span class="math notranslate nohighlight">\(k_{threshold}[m^6/mol^2/s] = 0.11\frac{T[K]}{\mu[Pa\cdot s]}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is the solvent viscosity. The coefficients in the above equations were obtained by using a
representative value of the molecular radius of 2 Angstrom. More details on the calculation of diffusion limits in the
liquid phase can be found in <a class="reference internal" href="../../users/rmg/liquids.html#liquids"><span class="std std-ref">the description of liquid-phase systems</span></a> under
<a class="reference internal" href="../../users/rmg/liquids.html#diffusionlimited"><span class="std std-ref">diffusion-limited kinetics</span></a>.</p>
<p>Three additional binary arrays <code class="docutils literal notranslate"><span class="pre">unimolecularReact</span></code>, <code class="docutils literal notranslate"><span class="pre">bimolecularReact</span></code>, and <code class="docutils literal notranslate"><span class="pre">trimolecularReact</span></code> store flags for
when the <code class="docutils literal notranslate"><span class="pre">unimolecularThreshold</span></code>, <code class="docutils literal notranslate"><span class="pre">bimolecularThreshold</span></code>, or <code class="docutils literal notranslate"><span class="pre">trimolecularThreshold</span></code> flag
shifts from <code class="docutils literal notranslate"><span class="pre">False</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.  RMG reacts species when the flag is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div>
</div>


          </div>
        </div>
      </div>
  <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
    <div class="sphinxsidebarwrapper">
        <div class="sidebarlogo"><a href="../../index.html">
            <img src="../../_static/rmg-logo-small.png" alt="RMG" />
        </a></div>
      <div id="sidebar">
        <div id="rmgsidebar">
          <a href="http://rmg.mit.edu">
            <div class="menuitem">
              <img src="../../_static/rmg-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG Website</div>
              <div class="menutext menudesc">Interactive website for RMG-Py</div>
            </div>
          </a>
          <a href="https://github.com/ReactionMechanismGenerator/RMG-Py">
            <div class="menuitem">
              <img src="../../_static/github-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG GitHub</div>
              <div class="menutext menudesc">View source and post issues</div>
            </div>
          </a>
        </div>
        <div class="menuitem">
  <h3><a href="../../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. Rate-based Model Enlarging Algorithm</a><ul>
<li><a class="reference internal" href="#filtering-reactions-within-the-rate-based-algorithm">1.1. Filtering Reactions within the Rate-based Algorithm</a></li>
</ul>
</li>
</ul>

        </div>
        <div class="menuitem">
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">RMG Theory Guide</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="prune.html"
                        title="next chapter"><span class="section-number">2. </span>Prune Edge Species</a></p>
        </div>
        <div class="menuitem">
<div role="note" aria-label="source link">
    <h3>This Page</h3>
        <ul class="this-page-menu">
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/issues">Report A Bug</a></li>
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/blob/master/documentation/source/theory/rmg/enlarger.rst"
                   rel="nofollow">View Source</a></li>
        </ul>
</div>
        </div>
        <div class="menuitem">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="prune.html" title="2. Prune Edge Species"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="RMG Theory Guide"
             >previous</a> |</li>
  <li><a href="http://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">3.0.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Theory Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >RMG Theory Guide</a> &#187;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2002-2020, William H. Green, Richard H. West, and the RMG Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.0.
    </div>
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-24556433-3");
    pageTracker._trackPageview();
  } catch(err) {}
</script>

  </body>
</html>