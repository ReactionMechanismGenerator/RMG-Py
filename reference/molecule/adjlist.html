
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Adjacency Lists &#8212; RMG-Py 2.1.0 Documentation</title>
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="rmgpy.molecule.symmetry" href="symmetry.html" />
    <link rel="prev" title="rmgpy.molecule.translator" href="translator.html" />
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    ce: ["Extension","mhchem"],
  });
});
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="symmetry.html" title="rmgpy.molecule.symmetry"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="translator.html" title="rmgpy.molecule.translator"
             accesskey="P">previous</a> |</li>
  <li><a href="http://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">2.2.1 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >RMG API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Molecular representations (<code class="docutils literal notranslate"><span class="pre">rmgpy.molecule</span></code>)</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-rmgpy.molecule.adjlist">
<span id="adjacency-lists"></span><span id="rmgpy-molecule-adjlist"></span><h1>Adjacency Lists<a class="headerlink" href="#module-rmgpy.molecule.adjlist" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The adjacency list syntax changed in July 2014.
The minimal requirement for most translations is to prefix the number
of unpaired electrons with the letter <cite>u</cite>.
The new syntax, however, allows much
greater flexibility, including definition of lone pairs, partial charges,
wildcards, and molecule multiplicities.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To quickly visualize any adjacency list, or to generate an adjacency list from
other types of molecular representations such as SMILES, InChI, or even common
species names, use the Molecule Search tool found here: <a class="reference external" href="http://rmg.mit.edu/molecule_search">http://rmg.mit.edu/molecule_search</a></p>
</div>
<p>An adjacency list is the most general way of specifying a chemical molecule or
molecular pattern in RMG. It is based on the adjacency list representation of
the graph data type –  the underlying data type for molecules and patterns in
RMG – but extended to allow for specification of extra semantic information.</p>
<p>The first line of most adjacency lists is a unique identifier for the molecule
or pattern the adjacency list represents. This is not strictly required, but
is recommended in most cases. Generally the identifier should only use
alphanumeric characters and the underscore, as if an identifier in many popular
programming languages. However, strictly speaking any non-space ASCII character
is allowed.</p>
<p>The subsequent lines may contain keyword-value pairs. Currently there is only
one keyword, <code class="docutils literal notranslate"><span class="pre">multiplicity</span></code>.</p>
<p>For species or molecule declarations, the value after <code class="docutils literal notranslate"><span class="pre">multiplicity</span></code> defines
the spin multiplicity of the molecule. E.g. <code class="docutils literal notranslate"><span class="pre">multiplicity</span> <span class="pre">1</span></code> for most ground state
closed shell species, <code class="docutils literal notranslate"><span class="pre">multiplicity</span> <span class="pre">2</span></code> for most radical species,
and <code class="docutils literal notranslate"><span class="pre">multiplicity</span> <span class="pre">3</span></code> for a triplet biradical.
If the <code class="docutils literal notranslate"><span class="pre">multiplicity</span></code> line is not present then a value of
(1 + number of unpaired electrons) is assumed.
Thus, it can usually be omitted, but if present can be used to distinguish,
for example, singlet CH2 from triplet CH2.</p>
<p>If defining a Functional <a class="reference internal" href="group.html#rmgpy.molecule.Group" title="rmgpy.molecule.Group"><code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code></a>, then the value must be a list,
which defines the multiplicities that will be matched by the group, eg.
<code class="docutils literal notranslate"><span class="pre">multiplicity</span> <span class="pre">[1,2,3]</span></code> or, for a single value, <code class="docutils literal notranslate"><span class="pre">multiplicity</span> <span class="pre">[1]</span></code>.
If a wildcard is desired, the line <code class="docutils literal notranslate"><span class="pre">'multiplicity</span> <span class="pre">x</span></code> can be used instead to accept
all multiplicities.  If the multiplicity line is omitted altogether, then a wildcard
is assumed.</p>
<p>e.g. the following two group adjlists represent identical groups.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>group1
multiplicity x
1    R!H u0
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>group2
1    R!H u0
</pre></div>
</div>
<p>After the identifier line and keyword-value lines,
each subsequent line describes a single atom and its
local bond structure. The format of these lines is a whitespace-delimited list
with tokens</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">label</span><span class="o">&gt;</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">element</span><span class="o">&gt;</span> <span class="n">u</span><span class="o">&lt;</span><span class="n">unpaired</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">p</span><span class="o">&lt;</span><span class="n">pairs</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">c</span><span class="o">&lt;</span><span class="n">charge</span><span class="o">&gt;</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">bondlist</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The first item is the number used to identify that atom. Any number may be used,
though it is recommended to number the atoms sequentially starting from one.
Next is an optional label used to tag that atom; this should be an
asterisk followed by a unique number for the label, e.g. <code class="docutils literal notranslate"><span class="pre">*1</span></code>.
In some cases (e.g. thermodynamics groups) there is only one labeled atom, and the label
is just an asterisk with no number: <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p>
<p>After that is
the atom’s element or atom type, indicated by its atomic symbol, followed by
a sequence of tokens describing the electronic state of the atom:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">u0</span></code> number of <strong>unpaired</strong> electrons (eg. radicals)</li>
<li><code class="docutils literal notranslate"><span class="pre">p0</span></code> number of lone <strong>pairs</strong> of electrons, common on oxygen and nitrogen.</li>
<li><code class="docutils literal notranslate"><span class="pre">c0</span></code> formal <strong>charge</strong> on the atom, e.g. <code class="docutils literal notranslate"><span class="pre">c-1</span></code> (negatively charged),
<code class="docutils literal notranslate"><span class="pre">c0</span></code>, <code class="docutils literal notranslate"><span class="pre">c+1</span></code> (positively charged)</li>
</ul>
<p>For <a class="reference internal" href="molecule.html#rmgpy.molecule.Molecule" title="rmgpy.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> definitions:
The value must be a single integer (and for charge must have a + or - sign if not equal to 0)
The number of unpaired electrons (i.e. radical electrons) is required, even if zero.
The number of lone pairs and the formal charge are assumed to be zero if omitted.</p>
<p>For <a class="reference internal" href="group.html#rmgpy.molecule.Group" title="rmgpy.molecule.Group"><code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code></a> definitions:
The value can be an integer or a list of integers (with signs, for charges),
eg. <code class="docutils literal notranslate"><span class="pre">u[0,1,2]</span></code> or <code class="docutils literal notranslate"><span class="pre">c[0,+1,+2,+3,+4]</span></code>, or may be a wildcard <code class="docutils literal notranslate"><span class="pre">x</span></code>
which matches any valid value,
eg. <code class="docutils literal notranslate"><span class="pre">px</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">p[0,1,2,3,4,</span> <span class="pre">...]</span></code> and <code class="docutils literal notranslate"><span class="pre">cx</span></code> is the same as
<code class="docutils literal notranslate"><span class="pre">c[...,-4,-3,-2,-1,0,+1,+2,+3,+4,...]</span></code>. Lists must be enclosed is square brackets,
and separated by commas, without spaces.
If lone pairs or formal charges are omitted from a group definition,
the wildcard is assumed.</p>
<p>The last set of tokens is the list of bonds.
To indicate a bond, place the number of the atom at the other end of the bond
and the bond type within curly braces and separated by a comma, e.g. <code class="docutils literal notranslate"><span class="pre">{2,S}</span></code>.
Multiple bonds from the same atom should be separated by whitespace.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You must take care to make sure each bond is listed on the lines of <em>both</em>
atoms in the bond, and that these entries have the same bond type. RMG will
raise an exception if it encounters such an invalid adjacency list.</p>
</div>
<p>When writing a molecular substructure pattern, you may specify multiple
elements, radical counts, and bond types as a comma-separated list inside square
brackets. For example, to specify any carbon or oxygen atom, use the syntax
<code class="docutils literal notranslate"><span class="pre">[C,O]</span></code>. For a single or double bond to atom 2, write <code class="docutils literal notranslate"><span class="pre">{2,[S,D]}</span></code>.</p>
<p>Atom types such as <code class="docutils literal notranslate"><span class="pre">R!H</span></code> or <code class="docutils literal notranslate"><span class="pre">Cdd</span></code> may also be used as a shorthand. (Atom types
like <code class="docutils literal notranslate"><span class="pre">Cdd</span></code> can also be
used in full molecules, but this use is discouraged, as RMG can compute them
automatically for full molecules.)</p>
<p>Below is an example adjacency list, for 1,3-hexadiene, with the weakest bond in
the molecule labeled with <code class="docutils literal notranslate"><span class="pre">*1</span></code> and <code class="docutils literal notranslate"><span class="pre">*2</span></code>. Note that hydrogen atoms
can be omitted if desired, as their presence is inferred, provided that unpaired
electrons, lone pairs, and charges are all correctly defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HXD13</span>
<span class="n">multiplicity</span> <span class="mi">1</span>
<span class="mi">1</span>    <span class="n">C</span> <span class="n">u0</span>       <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="n">D</span><span class="p">}</span>
<span class="mi">2</span>    <span class="n">C</span> <span class="n">u0</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="n">D</span><span class="p">}</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="n">S</span><span class="p">}</span>
<span class="mi">3</span>    <span class="n">C</span> <span class="n">u0</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="n">S</span><span class="p">}</span> <span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="n">D</span><span class="p">}</span>
<span class="mi">4</span>    <span class="n">C</span> <span class="n">u0</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="n">D</span><span class="p">}</span> <span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="n">S</span><span class="p">}</span>
<span class="mi">5</span> <span class="o">*</span><span class="mi">1</span> <span class="n">C</span> <span class="n">u0</span> <span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="n">S</span><span class="p">}</span> <span class="p">{</span><span class="mi">6</span><span class="p">,</span><span class="n">S</span><span class="p">}</span>
<span class="mi">6</span> <span class="o">*</span><span class="mi">2</span> <span class="n">C</span> <span class="n">u0</span> <span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="n">S</span><span class="p">}</span>
</pre></div>
</div>
<p>The allowed element types, radicals, and bonds are listed in the following table:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="19%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head">Notation</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td rowspan="5">Chemical Element</td>
<td>C</td>
<td>Carbon atom</td>
</tr>
<tr class="row-odd"><td>O</td>
<td>Oxygen atom</td>
</tr>
<tr class="row-even"><td>H</td>
<td>Hydrogen atom</td>
</tr>
<tr class="row-odd"><td>S</td>
<td>Sulfur atom</td>
</tr>
<tr class="row-even"><td>N</td>
<td>Nitrogen atom</td>
</tr>
<tr class="row-odd"><td rowspan="5">Nonreactive Elements</td>
<td>Si</td>
<td>Silicon atom</td>
</tr>
<tr class="row-even"><td>Cl</td>
<td>Chlorine atom</td>
</tr>
<tr class="row-odd"><td>He</td>
<td>Helium atom</td>
</tr>
<tr class="row-even"><td>Ar</td>
<td>Argon atom</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td rowspan="4">Chemical Bond</td>
<td>S</td>
<td>Single Bond</td>
</tr>
<tr class="row-odd"><td>D</td>
<td>Double Bond</td>
</tr>
<tr class="row-even"><td>T</td>
<td>Triple bond</td>
</tr>
<tr class="row-odd"><td>B</td>
<td>Benzene bond</td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="function">
<dt id="rmgpy.molecule.adjlist.fromAdjacencyList">
<code class="descclassname">rmgpy.molecule.adjlist.</code><code class="descname">fromAdjacencyList</code><span class="sig-paren">(</span><em>adjlist</em>, <em>group=False</em>, <em>saturateH=False</em><span class="sig-paren">)</span><a class="headerlink" href="#rmgpy.molecule.adjlist.fromAdjacencyList" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a string adjacency list <cite>adjlist</cite> into a set of <code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code> objects.</p>
</dd></dl>

<dl class="function">
<dt id="rmgpy.molecule.adjlist.toAdjacencyList">
<code class="descclassname">rmgpy.molecule.adjlist.</code><code class="descname">toAdjacencyList</code><span class="sig-paren">(</span><em>atoms</em>, <em>multiplicity</em>, <em>label=None</em>, <em>group=False</em>, <em>removeH=False</em>, <em>removeLonePairs=False</em>, <em>oldStyle=False</em><span class="sig-paren">)</span><a class="headerlink" href="#rmgpy.molecule.adjlist.toAdjacencyList" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a chemical graph defined by a list of <cite>atoms</cite> into a string
adjacency list.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
  <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
    <div class="sphinxsidebarwrapper">
        <div class="sidebarlogo"><a href="../../index.html">
            <img src="../../_static/rmg-logo-small.png" alt="RMG" />
        </a></div>
      <div id="sidebar">
        <div id="rmgsidebar">
          <a href="http://rmg.mit.edu">
            <div class="menuitem">
              <img src="../../_static/rmg-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG Website</div>
              <div class="menutext menudesc">Interactive website for RMG-Py</div>
            </div>
          </a>
          <a href="https://github.com/ReactionMechanismGenerator/RMG-Py">
            <div class="menuitem">
              <img src="../../_static/github-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG GitHub</div>
              <div class="menutext menudesc">View source and post issues</div>
            </div>
          </a>
        </div>
        <div class="menuitem">
        </div>
        <div class="menuitem">
  <h4>Previous topic</h4>
  <p class="topless"><a href="translator.html"
                        title="previous chapter">rmgpy.molecule.translator</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="symmetry.html"
                        title="next chapter">rmgpy.molecule.symmetry</a></p>
        </div>
        <div class="menuitem">
<div role="note" aria-label="source link">
    <h3>This Page</h3>
        <ul class="this-page-menu">
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/issues">Report A Bug</a></li>
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/blob/master/documentation/source/reference/molecule/adjlist.rst"
                   rel="nofollow">View Source</a></li>
        </ul>
</div>
        </div>
        <div class="menuitem">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="symmetry.html" title="rmgpy.molecule.symmetry"
             >next</a> |</li>
        <li class="right" >
          <a href="translator.html" title="rmgpy.molecule.translator"
             >previous</a> |</li>
  <li><a href="http://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">2.2.1 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >RMG API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Molecular representations (<code class="docutils literal notranslate"><span class="pre">rmgpy.molecule</span></code>)</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2002-2018, William H. Green, Richard H. West, and the RMG Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>