
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>6. Running a Job &#8212; RMG-Py 3.0.0 Documentation</title>
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="7. Analyzing the Output Files" href="output.html" />
    <link rel="prev" title="5. Example Input Files" href="examples.html" />
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    ce: ["Extension","mhchem"],
  });
});
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="output.html" title="7. Analyzing the Output Files"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="5. Example Input Files"
             accesskey="P">previous</a> |</li>
  <li><a href="http://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">3.0.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">RMG User’s Guide</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="running-a-job">
<span id="running"></span><h1><span class="section-number">6. </span>Running a Job<a class="headerlink" href="#running-a-job" title="Permalink to this headline">¶</a></h1>
<p><strong>Note:</strong> In all these examples <code class="docutils literal notranslate"><span class="pre">rmg.py</span></code> should be the path to your installed RMG (eg. yours might be <code class="docutils literal notranslate"><span class="pre">/Users/joeblogs/Code/RMG-Py/rmg.py</span></code>) and <code class="docutils literal notranslate"><span class="pre">input.py</span></code> is the path to the input file you wish to run (eg. yours might be <code class="docutils literal notranslate"><span class="pre">RMG-runs/hexadiene/input.py</span></code>).  If you get an error like <code class="docutils literal notranslate"><span class="pre">python:</span> <span class="pre">can't</span> <span class="pre">open</span> <span class="pre">file</span> <span class="pre">'rmg.py':</span> <span class="pre">[Errno</span> <span class="pre">2]</span> <span class="pre">No</span> <span class="pre">such</span> <span class="pre">file</span> <span class="pre">or</span> <span class="pre">directory</span></code>  then probably the first of these is wrong. If you get an error like <code class="docutils literal notranslate"><span class="pre">IOError:</span> <span class="pre">[Errno</span> <span class="pre">2]</span> <span class="pre">No</span> <span class="pre">such</span> <span class="pre">file</span> <span class="pre">or</span> <span class="pre">directory:</span> <span class="pre">'/some/path/to/input.py'</span></code> then probably the second of these is wrong.</p>
<p>Running a basic RMG job is straightforward, as shown in the example below. However, depending on your case you might want to add the flags outlined in the following section. We recommend you make a job-specific directory for each RMG simulation. Some jobs can take quite a while to complete, so we also recommend using a job scheduler if working in a linux environment.</p>
<p>Basic run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="section" id="input-flags">
<span id="inputflags"></span><h2><span class="section-number">6.1. </span>Input flags<a class="headerlink" href="#input-flags" title="Permalink to this headline">¶</a></h2>
<p>The options for input flags can be found in <code class="docutils literal notranslate"><span class="pre">/RMG-Py/rmgpy/util.py</span></code>. Running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<p>at the command line will print the documentation from <code class="docutils literal notranslate"><span class="pre">util.py</span></code>, which is reproduced below for convenience:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">q</span> <span class="o">|</span> <span class="o">-</span><span class="n">v</span> <span class="o">|</span> <span class="o">-</span><span class="n">d</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="n">DIR</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">r</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">seed</span><span class="o">/</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">p</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">P</span><span class="p">]</span>
      <span class="p">[</span><span class="o">-</span><span class="n">t</span> <span class="n">DD</span><span class="p">:</span><span class="n">HH</span><span class="p">:</span><span class="n">MM</span><span class="p">:</span><span class="n">SS</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">i</span> <span class="n">MAXITER</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">n</span> <span class="n">MAXPROC</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">k</span><span class="p">]</span>
      <span class="n">FILE</span>

<span class="n">Reaction</span> <span class="n">Mechanism</span> <span class="n">Generator</span> <span class="p">(</span><span class="n">RMG</span><span class="p">)</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">automatic</span> <span class="n">chemical</span> <span class="n">reaction</span> <span class="n">mechanism</span>
<span class="n">generator</span> <span class="n">that</span> <span class="n">constructs</span> <span class="n">kinetic</span> <span class="n">models</span> <span class="n">composed</span> <span class="n">of</span> <span class="n">elementary</span> <span class="n">chemical</span>
<span class="n">reaction</span> <span class="n">steps</span> <span class="n">using</span> <span class="n">a</span> <span class="n">general</span> <span class="n">understanding</span> <span class="n">of</span> <span class="n">how</span> <span class="n">molecules</span> <span class="n">react</span><span class="o">.</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="n">FILE</span>                  <span class="n">a</span> <span class="n">file</span> <span class="n">describing</span> <span class="n">the</span> <span class="n">job</span> <span class="n">to</span> <span class="n">execute</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">-</span><span class="n">q</span><span class="p">,</span> <span class="o">--</span><span class="n">quiet</span>           <span class="n">only</span> <span class="nb">print</span> <span class="n">warnings</span> <span class="ow">and</span> <span class="n">errors</span>
  <span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="o">--</span><span class="n">verbose</span>         <span class="nb">print</span> <span class="n">more</span> <span class="n">verbose</span> <span class="n">output</span>
  <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="o">--</span><span class="n">debug</span>           <span class="nb">print</span> <span class="n">debug</span> <span class="n">information</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">DIR</span><span class="p">,</span> <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">directory</span> <span class="n">DIR</span>
                        <span class="n">use</span> <span class="n">DIR</span> <span class="k">as</span> <span class="n">output</span> <span class="n">directory</span>
  <span class="o">-</span><span class="n">r</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">seed</span><span class="o">/</span><span class="p">,</span> <span class="o">--</span><span class="n">restart</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">seed</span><span class="o">/</span>
                        <span class="n">restart</span> <span class="n">RMG</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">seed</span>
  <span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="o">--</span><span class="n">profile</span>         <span class="n">run</span> <span class="n">under</span> <span class="n">cProfile</span> <span class="n">to</span> <span class="n">gather</span> <span class="n">profiling</span> <span class="n">statistics</span><span class="p">,</span> <span class="ow">and</span>
                        <span class="n">postprocess</span> <span class="n">them</span> <span class="k">if</span> <span class="n">job</span> <span class="n">completes</span>
  <span class="o">-</span><span class="n">P</span><span class="p">,</span> <span class="o">--</span><span class="n">postprocess</span>     <span class="n">postprocess</span> <span class="n">profiling</span> <span class="n">statistics</span> <span class="kn">from</span> <span class="nn">previous</span>
                        <span class="p">[</span><span class="n">failed</span><span class="p">]</span> <span class="n">run</span><span class="p">;</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">run</span> <span class="n">the</span> <span class="n">simulation</span>
  <span class="o">-</span><span class="n">t</span> <span class="n">DD</span><span class="p">:</span><span class="n">HH</span><span class="p">:</span><span class="n">MM</span><span class="p">:</span><span class="n">SS</span><span class="p">,</span> <span class="o">--</span><span class="n">walltime</span> <span class="n">DD</span><span class="p">:</span><span class="n">HH</span><span class="p">:</span><span class="n">MM</span><span class="p">:</span><span class="n">SS</span>
                        <span class="nb">set</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">execution</span> <span class="n">time</span>
  <span class="o">-</span><span class="n">i</span> <span class="n">MAXITER</span><span class="p">,</span> <span class="o">--</span><span class="n">maxiter</span> <span class="n">MAXITER</span>
                        <span class="nb">set</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">RMG</span> <span class="n">iterations</span>
  <span class="o">-</span><span class="n">n</span> <span class="n">MAXPROC</span><span class="p">,</span> <span class="o">--</span><span class="n">maxproc</span> <span class="n">MAXPROC</span>
                        <span class="nb">max</span> <span class="n">number</span> <span class="n">of</span> <span class="n">processes</span> <span class="n">used</span> <span class="n">during</span> <span class="n">reaction</span>
                        <span class="n">generation</span>
  <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="o">--</span><span class="n">kineticsdatastore</span>
                        <span class="n">output</span> <span class="n">a</span> <span class="n">folder</span><span class="p">,</span> <span class="n">kinetics_database</span><span class="p">,</span> <span class="n">that</span> <span class="n">contains</span> <span class="n">a</span>
                        <span class="o">.</span><span class="n">txt</span> <span class="n">file</span> <span class="k">for</span> <span class="n">each</span> <span class="n">reaction</span> <span class="n">family</span> <span class="n">listing</span> <span class="n">the</span>
                        <span class="n">source</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">each</span> <span class="n">entry</span>
</pre></div>
</div>
<p>Some representative example usages are shown below.</p>
<p>Run by restarting from a seed mechanism:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">r</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">seed</span><span class="o">/</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Run with CPU time profiling:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">p</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Run with multiprocessing for reaction generation and QMTP:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">n</span> <span class="o">&lt;</span><span class="n">Max</span> <span class="n">number</span> <span class="n">of</span> <span class="n">processes</span> <span class="n">allowed</span><span class="o">&gt;</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Run with setting a limit on the maximum execution time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">t</span> <span class="o">&lt;</span><span class="n">DD</span><span class="p">:</span><span class="n">HH</span><span class="p">:</span><span class="n">MM</span><span class="p">:</span><span class="n">SS</span><span class="o">&gt;</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Run with setting a limit on the maximum number of iterations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">Max</span> <span class="n">number</span> <span class="n">of</span> <span class="n">desired</span> <span class="n">iterations</span><span class="o">&gt;</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
<div class="section" id="details-on-the-multiprocessing-implementation">
<h2><span class="section-number">6.2. </span>Details on the multiprocessing implementation<a class="headerlink" href="#details-on-the-multiprocessing-implementation" title="Permalink to this headline">¶</a></h2>
<p>Currently, multiprocessing is implemented for reaction generation and the generation of QMfiles when using the QMTP option to compute thermodynamic properties of species. The processes are spawned and closed within each function. The number of processes is determined based on the ratio of currently available RAM and currently used RAM. The user can input the maximum number of allowed processes from the command line. For each reaction generation or QMTP call the number of processes will be the minimum value of either the number of allowed processes due to user input or the value obtained by the RAM ratio. The RAM limitation is employed, because multiprocessing is forking the base process and the memory limit (SWAP + RAM) might be exceeded when using too many processors for a base process large in memory.</p>
</div>
<div class="section" id="details-on-profiling-rmg-jobs">
<h2><span class="section-number">6.3. </span>Details on profiling RMG jobs<a class="headerlink" href="#details-on-profiling-rmg-jobs" title="Permalink to this headline">¶</a></h2>
<p>Here, we explain how to profile an RMG job. For starters, use the <code class="docutils literal notranslate"><span class="pre">saveSeedModulus</span></code> option in the input file, as described in the Section <a class="reference internal" href="input.html#miscellaneousoptions"><span class="std std-ref">Miscellaneous Options</span></a>, to save the seed mechanism at regular intervals, perhaps every 50 or 100 iterations depending on the size of the mechanism. This option is particularly important for saving intermediate steps when working with large mechanisms; it may be prudent to save and examine how the chemistry changes over mechanism development rather than just obtaining the final seed mechanism.</p>
<p>These seeds can then be restarted with use of the <code class="docutils literal notranslate"><span class="pre">-r</span></code> flag, as described in the Section <a class="reference internal" href="#inputflags"><span class="std std-ref">Input Flags</span></a> above. Additionally, restarting these seeds with the <code class="docutils literal notranslate"><span class="pre">-i</span></code> flag allows examination of how computational effort, time spent in each module, individual processor memory consumption if using the the <code class="docutils literal notranslate"><span class="pre">-n</span></code> flag, and overall memory consumption change over the course of mechanism development. To time profile, one could use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">r</span> <span class="o">&lt;</span><span class="n">path_to_seed</span><span class="o">&gt;/</span><span class="n">seed</span> <span class="o">-</span><span class="n">p</span> <span class="o">-</span><span class="n">i</span> <span class="mi">15</span> <span class="n">restart_from_seed</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>such that 15 iterations was arbitrarily chosen as a representative sample size to obtain profiling information. To run memory profiling, one option is to install a <a class="reference external" href="https://github.com/pythonprofilers/memory_profiler">python memory profiler</a> as an additional dependency. As detailed in their linked GitHub, there are options for line-by-line memory usage of small functions and for time-based memory usage.
An example of memory profiling is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mprof</span> <span class="n">run</span> <span class="o">--</span><span class="n">multiprocess</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">r</span> <span class="o">&lt;</span><span class="n">path_to_seed</span><span class="o">&gt;/</span><span class="n">seed</span> <span class="o">-</span><span class="n">i</span> <span class="mi">15</span> <span class="o">-</span><span class="n">n</span> <span class="mi">3</span> <span class="n">restart_from_seed</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>such that this example demonstrates how to obtain memory consumption for each of three specified processes and again use 15 iterations to obtain representative profiling information. Please see the linked GitHub to learn more about how the memory profiler tool can help characterize your process.</p>
</div>
</div>


          </div>
        </div>
      </div>
  <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
    <div class="sphinxsidebarwrapper">
        <div class="sidebarlogo"><a href="../../index.html">
            <img src="../../_static/rmg-logo-small.png" alt="RMG" />
        </a></div>
      <div id="sidebar">
        <div id="rmgsidebar">
          <a href="http://rmg.mit.edu">
            <div class="menuitem">
              <img src="../../_static/rmg-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG Website</div>
              <div class="menutext menudesc">Interactive website for RMG-Py</div>
            </div>
          </a>
          <a href="https://github.com/ReactionMechanismGenerator/RMG-Py">
            <div class="menuitem">
              <img src="../../_static/github-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG GitHub</div>
              <div class="menutext menudesc">View source and post issues</div>
            </div>
          </a>
        </div>
        <div class="menuitem">
  <h3><a href="../../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">6. Running a Job</a><ul>
<li><a class="reference internal" href="#input-flags">6.1. Input flags</a></li>
<li><a class="reference internal" href="#details-on-the-multiprocessing-implementation">6.2. Details on the multiprocessing implementation</a></li>
<li><a class="reference internal" href="#details-on-profiling-rmg-jobs">6.3. Details on profiling RMG jobs</a></li>
</ul>
</li>
</ul>

        </div>
        <div class="menuitem">
  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.html"
                        title="previous chapter"><span class="section-number">5. </span>Example Input Files</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="output.html"
                        title="next chapter"><span class="section-number">7. </span>Analyzing the Output Files</a></p>
        </div>
        <div class="menuitem">
<div role="note" aria-label="source link">
    <h3>This Page</h3>
        <ul class="this-page-menu">
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/issues">Report A Bug</a></li>
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/blob/master/documentation/source/users/rmg/running.rst"
                   rel="nofollow">View Source</a></li>
        </ul>
</div>
        </div>
        <div class="menuitem">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="output.html" title="7. Analyzing the Output Files"
             >next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="5. Example Input Files"
             >previous</a> |</li>
  <li><a href="http://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">3.0.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >RMG User’s Guide</a> &#187;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2002-2020, William H. Green, Richard H. West, and the RMG Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    </div>
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-24556433-3");
    pageTracker._trackPageview();
  } catch(err) {}
</script>

  </body>
</html>