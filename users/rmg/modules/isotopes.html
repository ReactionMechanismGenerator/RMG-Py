
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>9.10. Isotopes &#8212; RMG-Py 3.3.0 Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="10. Species Representation" href="../species.html" />
    <link rel="prev" title="9.9. Standardize Model Species Names" href="standardizeModelSpeciesNames.html" />
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    ce: ["Extension","mhchem"],
  });
});
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../species.html" title="10. Species Representation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="standardizeModelSpeciesNames.html" title="9.9. Standardize Model Species Names"
             accesskey="P">previous</a> |</li>
  <li><a href="https://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../../index.html">3.3.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >RMG User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U"><span class="section-number">9. </span>Standalone Modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">9.10. </span>Isotopes</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="isotopes">
<span id="id1"></span><h1><span class="section-number">9.10. </span>Isotopes<a class="headerlink" href="#isotopes" title="Permalink to this heading">¶</a></h1>
<section id="describing-isotopes-in-adjacency-lists">
<h2><span class="section-number">9.10.1. </span>Describing isotopes in adjacency lists<a class="headerlink" href="#describing-isotopes-in-adjacency-lists" title="Permalink to this heading">¶</a></h2>
<p>Isotopic enrichment can be indicated in a molecular structure’s adjacency list.
The example below is methane with an isotopically labeled carbon of isotope
number 13, which is indicated with <code class="docutils literal notranslate"><span class="pre">i13</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="n">C</span> <span class="n">u0</span> <span class="n">p0</span> <span class="n">c0</span> <span class="n">i13</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="n">S</span><span class="p">}</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="n">S</span><span class="p">}</span> <span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="n">S</span><span class="p">}</span> <span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="n">S</span><span class="p">}</span>
<span class="mi">2</span> <span class="n">H</span> <span class="n">u0</span> <span class="n">p0</span> <span class="n">c0</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="n">S</span><span class="p">}</span>
<span class="mi">3</span> <span class="n">H</span> <span class="n">u0</span> <span class="n">p0</span> <span class="n">c0</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="n">S</span><span class="p">}</span>
<span class="mi">4</span> <span class="n">H</span> <span class="n">u0</span> <span class="n">p0</span> <span class="n">c0</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="n">S</span><span class="p">}</span>
<span class="mi">5</span> <span class="n">H</span> <span class="n">u0</span> <span class="n">p0</span> <span class="n">c0</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="n">S</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="running-the-rmg-isotopes-algorithm">
<h2><span class="section-number">9.10.2. </span>Running the RMG isotopes algorithm<a class="headerlink" href="#running-the-rmg-isotopes-algorithm" title="Permalink to this heading">¶</a></h2>
<p>The isotopes script is located in the folder scripts. To run the algorithm,
ensure the RMG packages are loaded and type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">rmg</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">isotopes</span><span class="o">.</span><span class="n">py</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">file</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The input file is identical to a standard RMG input file and should contain the
conditions you want to run (unless you are inputting an already completed RMG
model). Without any options, the script will run the original RMG input file to
generate a model. Once the RMG job is finished, it will create new species for
all isotopologues of previously generated species and then generate all
reactions between the isotopologues.</p>
<p>Some arguments can be used to alter the behavior of the script. If you already
have a model (which includes atom mapping in RMG’s format) which you would like
to add isotope labels to, you can use the option <code class="docutils literal notranslate"><span class="pre">--original</span> <span class="pre">path/to/model/directory</span></code>
with the desired model files stored within with structure <code class="docutils literal notranslate"><span class="pre">chemkin/chem_annotated.inp</span></code>
and <code class="docutils literal notranslate"><span class="pre">chemkin/species_dictionary.txt</span></code>. With this option, the isotope script
will use the specified model instead of re-running an RMG job.</p>
<p>If you only desire the reactions contained in the specific RMG job,
you can add <code class="docutils literal notranslate"><span class="pre">--useOriginalReactions</span></code> in addition to <code class="docutils literal notranslate"><span class="pre">--original</span></code>.
This will create a full set of isotopically labeled versions of the reactions
you input and avoid a time-consuming generate reactions proceedure.
Note that without <code class="docutils literal notranslate"><span class="pre">--useOriginalReactions</span></code>, labeled and unlabeled reactions may
not match the same depository reactions, leading to inconsistent kinetics. If
degeneracy errors arise when generating reactions from scratch, try using this
option to see if it reduces errors in degeneracy.</p>
<p>The arguement <code class="docutils literal notranslate"><span class="pre">--maximumIsotopicAtoms</span> <span class="pre">[integer]</span></code> limits the number of enriched
atoms in any isotopologue in the model. This is beneficial for decreasing model
size, runtime of model creation and runtime necessary for analysis.</p>
<p>Adding kinetic isotope effects which are described in this paper can be obtained
through the argument <code class="docutils literal notranslate"><span class="pre">--kineticIsotopeEffect</span> <span class="pre">simple</span></code>. Currently this is the
only supported method, though this can be extended to other effects.</p>
<p>If you have a desired output folder, <code class="docutils literal notranslate"><span class="pre">--output</span> <span class="pre">output_folder_name</span></code> can direct
all output files to the specified folder. The default is to create a folder
named ‘iso’.</p>
<p>There are some limitations in what can be used in isotope models. In general,
RMG Reaction libraries and other methods of kinetic estimation that do not
involve atom mapping to reaction recipes are not compatible (though they can be
functional if all isotopologues are included in the reaction library). The
algorithm also does not function with pressure dependent mechanisms generated
by RMG, and has only been tested for gas phase kinetics. This algorithm currently
only works for Carbon-13 enrichments.</p>
<p>Following the generation, a number of diagnostics check model accuracy.
Isotopologues are checked to ensure their symmetries are consistent.
Then, the reaction path degeneracy among reactions differing only in isotope
labeling is checked to ensure it is consistent with the symmetry values of reactions.
If one of these checks throws a warning, the model will likely exhibit non-natural
fluctuations in enrichment ten to one hundred times larger than from non-hydrogen
kinetic isotope effects.</p>
</section>
<section id="output-from-script">
<h2><span class="section-number">9.10.3. </span>Output from script<a class="headerlink" href="#output-from-script" title="Permalink to this heading">¶</a></h2>
<p>The isotope generation script will output two files inside the nested folders
<code class="docutils literal notranslate"><span class="pre">iso/chemkin</span></code>, unless <code class="docutils literal notranslate"><span class="pre">--output</span></code> is specified. The file
<code class="docutils literal notranslate"><span class="pre">species_dictionary.txt</span></code> lists the structure of all isotopologue using the
RMG adjacency list structure. The other file of importance <code class="docutils literal notranslate"><span class="pre">chem_annotated.inp</span></code>
is a chemkin input file containing elements, species, thermo, and reactions of
the entire system.</p>
</section>
<section id="further-reading-resources">
<h2><span class="section-number">9.10.4. </span>Further reading &amp; resources<a class="headerlink" href="#further-reading-resources" title="Permalink to this heading">¶</a></h2>
<p>A description of mechanisms generated using this module and its application to
obtaining intramolecular isotopic enrichment information is described in
<a class="reference external" href="https://doi.org/10.1016/j.chemgeo.2019.02.036">Chemical Geology, Volume 514, page 1</a>.</p>
<p>Code to replicate that work, as well as convert between experimental enrichments
and the isotopologues used in RMG is deposited at <a class="reference external" href="https://doi.org/10.5281/zenodo.2567585">Zenodo</a>.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
  <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
    <div class="sphinxsidebarwrapper">
        <div class="sidebarlogo"><a href="../../../index.html">
            <img src="../../../_static/rmg-logo-small.png" alt="RMG" />
        </a></div>
      <div id="sidebar">
        <div id="rmgsidebar">
          <a href="https://rmg.mit.edu">
            <div class="menuitem">
              <img src="../../../_static/rmg-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG Website</div>
              <div class="menutext menudesc">Interactive website for RMG-Py</div>
            </div>
          </a>
          <a href="https://github.com/ReactionMechanismGenerator/RMG-Py">
            <div class="menuitem">
              <img src="../../../_static/github-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG GitHub</div>
              <div class="menutext menudesc">View source and post issues</div>
            </div>
          </a>
        </div>
        <div class="menuitem">
  <div>
    <h3><a href="../../../contents.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">9.10. Isotopes</a><ul>
<li><a class="reference internal" href="#describing-isotopes-in-adjacency-lists">9.10.1. Describing isotopes in adjacency lists</a></li>
<li><a class="reference internal" href="#running-the-rmg-isotopes-algorithm">9.10.2. Running the RMG isotopes algorithm</a></li>
<li><a class="reference internal" href="#output-from-script">9.10.3. Output from script</a></li>
<li><a class="reference internal" href="#further-reading-resources">9.10.4. Further reading &amp; resources</a></li>
</ul>
</li>
</ul>

  </div>
        </div>
        <div class="menuitem">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="standardizeModelSpeciesNames.html"
                          title="previous chapter"><span class="section-number">9.9. </span>Standardize Model Species Names</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../species.html"
                          title="next chapter"><span class="section-number">10. </span>Species Representation</a></p>
  </div>
        </div>
        <div class="menuitem">
<div role="note" aria-label="source link">
    <h3>This Page</h3>
        <ul class="this-page-menu">
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/issues">Report A Bug</a></li>
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/blob/main/documentation/source/users/rmg/modules/isotopes.rst"
                   rel="nofollow">View Source</a></li>
        </ul>
</div>
        </div>
        <div class="menuitem">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../species.html" title="10. Species Representation"
             >next</a> |</li>
        <li class="right" >
          <a href="standardizeModelSpeciesNames.html" title="9.9. Standardize Model Species Names"
             >previous</a> |</li>
  <li><a href="https://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../../index.html">3.3.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >RMG User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" ><span class="section-number">9. </span>Standalone Modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">9.10. </span>Isotopes</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2002-2025, William H. Green, Richard H. West, and the RMG Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-24556433-3");
    pageTracker._trackPageview();
  } catch(err) {}
</script>

  </body>
</html>