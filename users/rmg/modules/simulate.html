
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>9.5. Simulation and Sensitivity/Uncertainty Analysis &#8212; RMG-Py 3.3.0 Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="9.6. Generating Flux Diagrams" href="generateFluxDiagram.html" />
    <link rel="prev" title="9.4. Generate Reactions" href="generateReactions.html" />
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    ce: ["Extension","mhchem"],
  });
});
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="generateFluxDiagram.html" title="9.6. Generating Flux Diagrams"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="generateReactions.html" title="9.4. Generate Reactions"
             accesskey="P">previous</a> |</li>
  <li><a href="https://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../../index.html">3.3.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >RMG User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U"><span class="section-number">9. </span>Standalone Modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">9.5. </span>Simulation and Sensitivity/Uncertainty Analysis</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="simulation-and-sensitivity-uncertainty-analysis">
<span id="simulate"></span><h1><span class="section-number">9.5. </span>Simulation and Sensitivity/Uncertainty Analysis<a class="headerlink" href="#simulation-and-sensitivity-uncertainty-analysis" title="Permalink to this heading">¶</a></h1>
<p>For sensitivity analysis, RMG-Py must be compiled with the DASPK solver, which is done by default but has
some dependency restrictions. (See <a class="reference internal" href="../installation/dependencies.html#dependenciesrestrictions"><span class="std std-ref">License Restrictions on Dependencies</span></a> for more details.)
Sensitivity analysis or a simulation (without sensitivity) can be conducted in a standalone system for an existing
kinetics model in Chemkin format.</p>
<p>To run a simulation and/or sensitivity analysis, use the simulate module in RMG-Py/scripts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">simulate</span><span class="o">.</span><span class="n">py</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span> <span class="n">chem</span><span class="o">.</span><span class="n">inp</span> <span class="n">species_dictionary</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">chem.inp</span></code> is the CHEMKIN file and the <code class="docutils literal notranslate"><span class="pre">species_dictionary.txt</span></code> contains the dictionary of
species associated with the CHEMKIN file.  <code class="docutils literal notranslate"><span class="pre">input.py</span></code> is an input file similar to one used for an RMG job but
does not generate a RMG job.  See the following <code class="docutils literal notranslate"><span class="pre">input.py</span></code> example file found under the
<code class="docutils literal notranslate"><span class="pre">$RMGPy/examples/sensitivity/input.py</span></code> folder</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data sources</span>
<span class="n">database</span><span class="p">(</span>
    <span class="n">thermoLibraries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;primaryThermoLibrary&#39;</span><span class="p">],</span>
    <span class="n">reactionLibraries</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">seedMechanisms</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">kineticsDepositories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;training&#39;</span><span class="p">],</span>
    <span class="n">kineticsFamilies</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;!Intra_Disproportionation&#39;</span><span class="p">,</span><span class="s1">&#39;!Substitution_O&#39;</span><span class="p">],</span>
    <span class="n">kineticsEstimator</span> <span class="o">=</span> <span class="s1">&#39;rate rules&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Constraints on generated species</span>
<span class="n">generatedSpeciesConstraints</span><span class="p">(</span>
    <span class="n">maximumRadicalElectrons</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># List of species</span>
<span class="n">species</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ethane&#39;</span><span class="p">,</span>
    <span class="n">reactive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">structure</span><span class="o">=</span><span class="n">SMILES</span><span class="p">(</span><span class="s2">&quot;CC&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Reaction systems</span>
<span class="n">simpleReactor</span><span class="p">(</span>
    <span class="n">temperature</span><span class="o">=</span><span class="p">(</span><span class="mi">1350</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
    <span class="n">pressure</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="s1">&#39;bar&#39;</span><span class="p">),</span>
    <span class="n">initialMoleFractions</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;ethane&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">terminationConversion</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;ethane&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">terminationTime</span><span class="o">=</span><span class="p">(</span><span class="mf">1e6</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">),</span>
    <span class="n">sensitivity</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ethane&#39;</span><span class="p">],</span>
    <span class="n">sensitivityThreshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">simulator</span><span class="p">(</span>
    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-16</span><span class="p">,</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span>
    <span class="n">sens_atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">sens_rtol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="p">(</span>
    <span class="n">toleranceKeepInEdge</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">toleranceMoveToCore</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">toleranceInterruptSimulation</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">maximumEdgeSpecies</span><span class="o">=</span><span class="mi">100000</span>
<span class="p">)</span>

<span class="n">options</span><span class="p">(</span>
    <span class="n">units</span><span class="o">=</span><span class="s1">&#39;si&#39;</span><span class="p">,</span>
    <span class="n">saveSimulationProfiles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">generateOutputHTML</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">generatePlots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The names of species named in the input file must coincide with the names specified in the CHEMKIN file.</p>
<p>Other options that can be specified for the <code class="docutils literal notranslate"><span class="pre">simulate.py</span></code> scripts are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">dlim</span>      <span class="n">Turn</span> <span class="n">off</span> <span class="n">diffusion</span><span class="o">-</span><span class="n">limited</span> <span class="n">rates</span> <span class="k">for</span> <span class="n">LiquidReactor</span>
<span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="o">--</span><span class="n">foreign</span>  <span class="n">Not</span> <span class="n">an</span> <span class="n">RMG</span> <span class="n">generated</span> <span class="n">Chemkin</span> <span class="n">file</span> <span class="p">(</span><span class="n">will</span> <span class="n">be</span> <span class="n">checked</span> <span class="k">for</span> <span class="n">duplicates</span><span class="p">)</span>
</pre></div>
</div>
<p>Sensitivity analysis is conducted for the list of species given for the <code class="docutils literal notranslate"><span class="pre">sensitivity</span></code> argument in the input file.
The normalized concentration sensitivities with respect to the reaction rate coefficients dln(C_i)/dln(k_j) are saved to a csv file
with the file name <code class="docutils literal notranslate"><span class="pre">sensitivity_1_SPC_1.csv</span></code> with the first index value indicating the reactor system and the second naming the index of the species
the sensitivity analysis is conducted for.  Sensitivities to thermo of individual species is also saved as semi normalized sensitivities
dln(C_i)/d(G_j) where the units are given in 1/(kcal mol-1). The sensitivityThreshold is set to some value so that only
sensitivities for dln(C_i)/dln(k_j) &gt; sensitivityThreshold  or dlnC_i/d(G_j) &gt; sensitivityThreshold are saved to this file.</p>
<p>Uncertainty analysis can also be requested via input file options. For more details, see <a class="reference internal" href="../input.html#uncertaintyanalysis"><span class="std std-ref">Uncertainty Analysis</span></a>.
The results of the analysis will be printed in the <code class="docutils literal notranslate"><span class="pre">simulate.log</span></code> file which is generated.</p>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
  <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
    <div class="sphinxsidebarwrapper">
        <div class="sidebarlogo"><a href="../../../index.html">
            <img src="../../../_static/rmg-logo-small.png" alt="RMG" />
        </a></div>
      <div id="sidebar">
        <div id="rmgsidebar">
          <a href="https://rmg.mit.edu">
            <div class="menuitem">
              <img src="../../../_static/rmg-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG Website</div>
              <div class="menutext menudesc">Interactive website for RMG-Py</div>
            </div>
          </a>
          <a href="https://github.com/ReactionMechanismGenerator/RMG-Py">
            <div class="menuitem">
              <img src="../../../_static/github-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG GitHub</div>
              <div class="menutext menudesc">View source and post issues</div>
            </div>
          </a>
        </div>
        <div class="menuitem">
        </div>
        <div class="menuitem">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="generateReactions.html"
                          title="previous chapter"><span class="section-number">9.4. </span>Generate Reactions</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="generateFluxDiagram.html"
                          title="next chapter"><span class="section-number">9.6. </span>Generating Flux Diagrams</a></p>
  </div>
        </div>
        <div class="menuitem">
<div role="note" aria-label="source link">
    <h3>This Page</h3>
        <ul class="this-page-menu">
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/issues">Report A Bug</a></li>
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/blob/main/documentation/source/users/rmg/modules/simulate.rst"
                   rel="nofollow">View Source</a></li>
        </ul>
</div>
        </div>
        <div class="menuitem">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="generateFluxDiagram.html" title="9.6. Generating Flux Diagrams"
             >next</a> |</li>
        <li class="right" >
          <a href="generateReactions.html" title="9.4. Generate Reactions"
             >previous</a> |</li>
  <li><a href="https://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../../index.html">3.3.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >RMG User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" ><span class="section-number">9. </span>Standalone Modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">9.5. </span>Simulation and Sensitivity/Uncertainty Analysis</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2002-2025, William H. Green, Richard H. West, and the RMG Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-24556433-3");
    pageTracker._trackPageview();
  } catch(err) {}
</script>

  </body>
</html>