<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3. Creating Input Files for Thermodynamics and High-Pressure Limit Kinetics Computations &mdash; RMG Py 1.0.alpha documentation</title>
    
    <link rel="stylesheet" href="../../_static/rmg.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="RMG Py 1.0.alpha documentation" href="../../contents.html" />
    <link rel="up" title="CanTherm User’s Guide" href="index.html" />
    <link rel="next" title="4. Creating Input Files for Pressure Dependent Calculations" href="input_pdep.html" />
    <link rel="prev" title="2. Installation" href="installation.html" />
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    ce: ["Extension","mhchem"],
  });
});
</script>

  </head>
  <body role="document">
<div class="header">
&nbsp;
</div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="input_pdep.html" title="4. Creating Input Files for Pressure Dependent Calculations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="2. Installation"
             accesskey="P">previous</a> |</li>
<li><a href="../../index.html">Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >User&#8217;s Guide</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">CanTherm User&#8217;s Guide</a> &raquo;</li> 
      </ul>
    </div>
            
  <div class="section" id="creating-input-files-for-thermodynamics-and-high-pressure-limit-kinetics-computations">
<h1>3. Creating Input Files for Thermodynamics and High-Pressure Limit Kinetics Computations<a class="headerlink" href="#creating-input-files-for-thermodynamics-and-high-pressure-limit-kinetics-computations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="syntax">
<h2>3.1. Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<p>The format of CanTherm input files is based on Python syntax. In fact, CanTherm
input files are valid Python source code, and this is used to facilitate
reading of the file.</p>
<p>Each section is made up of one or more function calls, where parameters are
specified as text strings, numbers, or objects. Text strings must be wrapped in
either single or double quotes.</p>
</div>
<div class="section" id="model-chemistry">
<h2>3.2. Model Chemistry<a class="headerlink" href="#model-chemistry" title="Permalink to this headline">¶</a></h2>
<p>The first item in the input file should be a <code class="docutils literal"><span class="pre">modelChemistry()</span></code> function,
which accepts a string describing the model chemistry. Currently the
allowed model chemistries are:
<code class="docutils literal"><span class="pre">'CBS-QB3'</span></code>
<code class="docutils literal"><span class="pre">'G3'</span></code>
<code class="docutils literal"><span class="pre">'M08SO/MG3S*'</span></code> * indicates that the grid size used in the [QChem] electronic structure calculation utilized 75 radial points and 434 angular points
<code class="docutils literal"><span class="pre">'CCSD(T)-F12/cc-pVnZ-F12'</span></code>  n = D, T, Q
<code class="docutils literal"><span class="pre">'CCSD(T)-F12/aug-cc-pVnZ-F12'</span></code>  n = D, T, Q
<code class="docutils literal"><span class="pre">'MP2_rmp2_pVnZ'</span></code>  n = D, T, Q
<code class="docutils literal"><span class="pre">'FCI/cc-pVnZ'</span></code>  n = D, T, Q
<code class="docutils literal"><span class="pre">'DFT_G03_b3lyp'</span></code>  a B3LYP calculation with a moderately large basis set
<code class="docutils literal"><span class="pre">'BMK/cbsb7'</span></code> or  <code class="docutils literal"><span class="pre">'BMK/6-311G(2d,d,p)'</span></code></p>
<p>CanTherm uses this information to adjust the computed energies to the usual gas-phase reference
states by applying atom, bond and spin-orbit coupling energy corrections. This is particularly important for <code class="docutils literal"><span class="pre">thermo()</span></code> calculations (see below). The example below
demonstrates how to specify CBS-QB3 as a model chemistry:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">modelChemistry</span><span class="p">(</span><span class="s">&quot;CBS-QB3&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="species">
<h2>3.3. Species<a class="headerlink" href="#species" title="Permalink to this headline">¶</a></h2>
<p>Each species of interest must be specified using a <code class="docutils literal"><span class="pre">species()</span></code> function,
which accepts the following parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">label</span></code></td>
<td>A unique string label used as an identifier</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">geomLog</span></code></td>
<td>The path to the Gaussian log file containing the optimized geometry</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">statesLog</span></code></td>
<td>The path to the Gaussian log file containing the computed frequencies</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">extSymmetry</span></code></td>
<td>The external symmetry number for rotation</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">freqScaleFactor</span></code></td>
<td>A factor by which to scale all frequencies</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">linear</span></code></td>
<td><code class="docutils literal"><span class="pre">True</span></code> if the molecule is linear, <code class="docutils literal"><span class="pre">False</span></code> if not</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">rotors</span></code></td>
<td>A list of <code class="xref py py-class docutils literal"><span class="pre">HinderedRotor()</span></code> objects describing the hindered rotors</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">atoms</span></code></td>
<td>A dict associating atom symbols with the number of each atom in the molecule</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">bonds</span></code></td>
<td>A dict associating bond types with the number of each bond in the molecule</td>
</tr>
</tbody>
</table>
<p>The geometry and states log files can be identical if you computed them in the
same Gaussian output. Allowed atom symbols for the <code class="docutils literal"><span class="pre">atoms</span></code> parameter are
<code class="docutils literal"><span class="pre">'C'</span></code>, <code class="docutils literal"><span class="pre">'H'</span></code>, <code class="docutils literal"><span class="pre">'N'</span></code>, <code class="docutils literal"><span class="pre">'O'</span></code>, and <code class="docutils literal"><span class="pre">'P'</span></code>. Allowed bond types for the
<code class="docutils literal"><span class="pre">bonds</span></code> parameter are <code class="docutils literal"><span class="pre">'C-H'</span></code>, <code class="docutils literal"><span class="pre">'C-C'</span></code>, <code class="docutils literal"><span class="pre">'C=C'</span></code>, <code class="docutils literal"><span class="pre">'C#C'</span></code>, <code class="docutils literal"><span class="pre">'O-H'</span></code>,
<code class="docutils literal"><span class="pre">'C-O'</span></code>, <code class="docutils literal"><span class="pre">'C-O'</span></code>, <code class="docutils literal"><span class="pre">'C=O'</span></code>, <code class="docutils literal"><span class="pre">'N#N'</span></code>, <code class="docutils literal"><span class="pre">'O=O'</span></code>, <code class="docutils literal"><span class="pre">'H-H'</span></code>, and
<code class="docutils literal"><span class="pre">'C#N'</span></code>. In both cases you can omit atoms and bonds not present in your
species, and their counts will be automatically set to zero.</p>
<p>Each <code class="xref py py-class docutils literal"><span class="pre">HinderedRotor()</span></code> object requires the following parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">scanLog</span></code></td>
<td>The path to the Gaussian/Qchem log file containing the scan</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">pivots</span></code></td>
<td>The indices of the atoms in the hindered rotor torsional bond</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">top</span></code></td>
<td>The indices of all atoms on one side of the torsional bond (including the pivot atom)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">symmetry</span></code></td>
<td>The symmetry number for the torsional rotation</td>
</tr>
</tbody>
</table>
<p>The following is an example of a typical species item, based on ethane:</p>
<div class="highlight-python"><div class="highlight"><pre>species(
    label = &#39;ethane&#39;,
    geomLog = &#39;ethane_cbs.log&#39;,
    statesLog = &#39;ethane_cbs.log&#39;,
    extSymmetry = 2,
    freqScaleFactor = 0.99,
    linear = False,
    rotors = [
        HinderedRotor(scanLog=&#39;ethane_scan_1.log&#39;, pivots=[0,4], top=[0,1,2,3], symmetry=3),
    ]
    atoms = {&#39;C&#39;: 2, &#39;H&#39;: 6},
    bonds = {&#39;C-C&#39;: 1, &#39;C-H&#39;: 6},
)
</pre></div>
</div>
<p>Note that the atoms identified within the rotor section should correspond to the geometry indicated by
<code class="docutils literal"><span class="pre">geomLog</span></code>.</p>
</div>
<div class="section" id="transition-state">
<h2>3.4. Transition State<a class="headerlink" href="#transition-state" title="Permalink to this headline">¶</a></h2>
<p>Each transition state of interest must be specified using a
<code class="docutils literal"><span class="pre">transitionState()</span></code> function, which accepts exactly the same parameters as
the <code class="docutils literal"><span class="pre">species()</span></code> function described above. This is only required if you wish
to perform a kinetics computation.</p>
<p>The following is an example of a typical transition state item:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">transitionState</span><span class="p">(</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;TS&#39;</span><span class="p">,</span>
    <span class="n">geomLog</span> <span class="o">=</span> <span class="s">&#39;H+C2H4.log&#39;</span><span class="p">,</span>
    <span class="n">statesLog</span> <span class="o">=</span> <span class="s">&#39;H+C2H4.log&#39;</span><span class="p">,</span>
    <span class="n">extSymmetry</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">freqScaleFactor</span> <span class="o">=</span> <span class="mf">0.99</span><span class="p">,</span>
    <span class="n">linear</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
    <span class="n">rotors</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
    <span class="n">bonds</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;C-C&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;C-H&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="reaction">
<h2>3.5. Reaction<a class="headerlink" href="#reaction" title="Permalink to this headline">¶</a></h2>
<p>Each reaction of interest must be specified using a <code class="docutils literal"><span class="pre">reaction()</span></code> function,
which accepts the following parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">label</span></code></td>
<td>A unique string label used as an identifier</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">reactants</span></code></td>
<td>A list of strings indicating the labels of the reactant species</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">products</span></code></td>
<td>A list of strings indicating the labels of the product species</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">transitionState</span></code></td>
<td>The string label of the transition state</td>
</tr>
</tbody>
</table>
<p>This is only required if you wish to perform a kinetics computation. The
following is an example of a typical reaction item:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">reaction</span><span class="p">(</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;H + C2H4 &lt;=&gt; C2H5&#39;</span><span class="p">,</span>
    <span class="n">reactants</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="s">&#39;C2H4&#39;</span><span class="p">],</span>
    <span class="n">products</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;C2H5&#39;</span><span class="p">],</span>
    <span class="n">transitionState</span> <span class="o">=</span> <span class="s">&#39;TS&#39;</span><span class="p">,</span>
    <span class="n">tunneling</span><span class="o">=</span><span class="s">&#39;Eckart&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that in the above example, &#8216;Wigner&#8217; is also an acceptable method of estimating the
quantum tunneling factor.</p>
</div>
<div class="section" id="thermodynamics-computations">
<h2>3.6. Thermodynamics Computations<a class="headerlink" href="#thermodynamics-computations" title="Permalink to this headline">¶</a></h2>
<p>Use a <code class="docutils literal"><span class="pre">thermo()</span></code> function to compute the thermodynamic parameters for a
species. Pass the string label of the species you wish to compute the
thermodynamic parameters for and the type of thermodynamics model to
generate (either <code class="docutils literal"><span class="pre">'Wilhoit'</span></code> or &#8216;&#8217;<cite>NASA</cite>&#8216;&#8217; for a Wilhoit polynomial
model or NASA polynomial model). A table of thermodynamic parameters will
also be displayed in the output file.</p>
<p>Below is a typical <code class="docutils literal"><span class="pre">thermo()</span></code> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">thermo</span><span class="p">(</span><span class="s">&#39;ethane&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s">&#39;Wilhoit&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="kinetics-computations">
<h2>3.7. Kinetics Computations<a class="headerlink" href="#kinetics-computations" title="Permalink to this headline">¶</a></h2>
<p>Use a <code class="docutils literal"><span class="pre">kinetics()</span></code> function to compute the high-pressure limit kinetic parameters for a
reaction.  If desired, define a desired temperature range and number of temperatures
at which the high-pressure rate coefficient will be tabulated and saved to
the outupt file. 3-parameter modified Arrhenius coefficients will automatically be fit
to the computed rate coefficients. The quantum tunneling factor will also be displayed</p>
<p>Below is a typical <code class="docutils literal"><span class="pre">kinetics()</span></code> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">kinetics</span><span class="p">(</span>
<span class="n">label</span> <span class="o">=</span> <span class="s">&#39;H + C2H4 &lt;=&gt; C2H5&#39;</span><span class="p">,</span>
<span class="n">Tmin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="s">&#39;K&#39;</span><span class="p">),</span> <span class="n">Tmax</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1200</span><span class="p">,</span><span class="s">&#39;K&#39;</span><span class="p">),</span> <span class="n">Tcount</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
<span class="n">Tlist</span> <span class="o">=</span> <span class="p">([</span><span class="mi">400</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">700</span><span class="p">,</span><span class="mi">900</span><span class="p">,</span><span class="mi">1100</span><span class="p">,</span><span class="mi">1200</span><span class="p">],</span><span class="s">&#39;K&#39;</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This is also acceptable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">kinetics</span><span class="p">(</span><span class="s">&#39;H + C2H4 &lt;=&gt; C2H5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h2>3.8. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Perhaps the best way to learn the input file syntax is by example. To that end,
a number of example input files and their corresponding output have been given
in the <code class="docutils literal"><span class="pre">examples</span></code> directory.</p>
</div>
<div class="section" id="troubleshooting-and-faqs">
<h2>3.9. Troubleshooting and FAQs<a class="headerlink" href="#troubleshooting-and-faqs" title="Permalink to this headline">¶</a></h2>
<p>1) The network that CanTherm generated and the resulting pdf file show abnormally large
absolute values. What&#8217;s going on?</p>
<blockquote>
<div>This can happen if the number of atoms and atom types is not properly defined or consistent in your input file(s).</div></blockquote>
</div>
<div class="section" id="cantherm-user-checklist">
<h2>3.10. Cantherm User Checklist<a class="headerlink" href="#cantherm-user-checklist" title="Permalink to this headline">¶</a></h2>
<p>Using cantherm, or any rate theory package for that matter, requires careful consideration and management of a large amount of data, files, and input parameters. As a result, it is easy to make a mistake somewhere. This checklist was made to minimize such mistakes for users:</p>
<ul class="simple">
<li>Do correct paths exist for pointing to the files containing the electronic energies, molecular geometries and vibrational frequencies?</li>
</ul>
<p>For calculations involving pressure dependence:</p>
<ul class="simple">
<li>Does the network pdf look reasonable? That is, are the relative energies what you expect based on the input?</li>
</ul>
<p>For calculations using internal hindered rotors:</p>
<ul class="simple">
<li>Did you check to make sure the rotor has a reasonable potential (e.g., visually inspect the automatically generated rotor pdf files)?</li>
<li>Within your input files, do all specified rotors point to the correct files?</li>
<li>Do all of the atom label indices correspond to those in the file that is read by the logger (GaussianLog, QchemLog, etc.)?</li>
<li>Why do the fourier fits look so much different than the results of the ab initio potential energy scan calculations? This is likely because the initial scan energy is not at a minimum. One solution is to simply shift the potential with respect to angle so that it starts at zero and, instead of having CanTherm read a Qchem or Gaussian output file, have CanTherm point to a &#8216;ScanLog&#8217; file. Another problem can arise when the potential at 2*pi is also not [close] to zero.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div class="sidebarlogo">
<a href="../../index.html"><img src="../../_static/rmg-logo-small.png" alt="RMG" /></a>
</div>
  <h3><a href="../../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3. Creating Input Files for Thermodynamics and High-Pressure Limit Kinetics Computations</a><ul>
<li><a class="reference internal" href="#syntax">3.1. Syntax</a></li>
<li><a class="reference internal" href="#model-chemistry">3.2. Model Chemistry</a></li>
<li><a class="reference internal" href="#species">3.3. Species</a></li>
<li><a class="reference internal" href="#transition-state">3.4. Transition State</a></li>
<li><a class="reference internal" href="#reaction">3.5. Reaction</a></li>
<li><a class="reference internal" href="#thermodynamics-computations">3.6. Thermodynamics Computations</a></li>
<li><a class="reference internal" href="#kinetics-computations">3.7. Kinetics Computations</a></li>
<li><a class="reference internal" href="#examples">3.8. Examples</a></li>
<li><a class="reference internal" href="#troubleshooting-and-faqs">3.9. Troubleshooting and FAQs</a></li>
<li><a class="reference internal" href="#cantherm-user-checklist">3.10. Cantherm User Checklist</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation.html"
                        title="previous chapter">2. Installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="input_pdep.html"
                        title="next chapter">4. Creating Input Files for Pressure Dependent Calculations</a></p>
  <h3>This Page </h3>
  <ul class="this-page-menu">
    <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/blob/master/documentation/source/users/cantherm/input.rst"
           rel="nofollow">Edit this page</a></li>
  </ul>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, William H. Green, Richard H. West, and the RMG Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>